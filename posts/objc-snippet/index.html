<!doctype html><html lang=en-us><title>Objc Snippet | Blog by Frank</title>
<meta charset=utf-8><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZQ6YTCMN7"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XZQ6YTCMN7",{anonymize_ip:!1})}</script><meta name=twitter:card content="summary_large_image"><meta property="og:type" content="article"><meta property="og:title" content="Objc Snippet | Blog by Frank"><meta name=twitter:title content="Objc Snippet | Blog by Frank"><meta property="og:description" content="Type unsafe

isEqual
isEqualTo
OC底层原理之isEqual
isEqual

NSLog(@&#34;%d&#34;, false == 0);
NSLog(@&#34;%d&#34;, nil == 0);
NSLog(@&#34;%d&#34;, 0 == 0);
NSLog(@&#34;%d&#34;, [false isEqual:0]);

if (nil == 0) {
    NSLog(@&#34;equal&#34;);
}
Nil Safe Solution
[InterfaceName toGetNSDictionary:self.model.businessInfo?:@{}];
这行代码的意思是，首先检查 self.model.businessInfo 是否为 nil，如果不是 nil，则使用 self.model.businessInfo，否则返回一个空的 NSDictionary 对象 {}。"><meta property="og:url" content="https://yongfrank.github.io/posts/objc-snippet/"><meta property="og:site_name" content="Blog by Frank"><meta name=generator content="Hugo 0.120.4"><meta name=description content="Explorations, Reflections, and More on My Blog"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://yongfrank.github.io/css/index.css><link rel=canonical href=https://yongfrank.github.io/posts/objc-snippet/><link rel=alternate type=application/rss+xml href title="Blog by Frank"><link rel=stylesheet href=https://yongfrank.github.io/katex/katex.min.css><link rel="shortcut icon" href=favicon.ico><script defer src=https://yongfrank.github.io/katex/katex.min.js></script><script defer src=https://yongfrank.github.io/katex/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#578490><meta name=msapplication-TileColor content="#da532c"><head><script src=/js/MathJax/es5/tex-chtml.js></script></head><header><a href=https://yongfrank.github.io/ class=title>Blog by Frank</a><nav><a href=/about/>About</a></nav></header><article><header><h1>Objc Snippet</h1><time datetime=2023-03-29T21:18:40+08:00>March 29, 2023</time></header><nav id=TableOfContents><ul><li><a href=#type-unsafe>Type unsafe</a></li><li><a href=#nil-safe-solution>Nil Safe Solution</a></li><li><a href=#class-in-objective-c>Class in Objective-C</a><ul><li><a href=#quickstarthttpswwwtutorialspointcomobjective_cobjective_c_quick_guidehtm><a href=https://www.tutorialspoint.com/objective_c/objective_c_quick_guide.htm>QuickStart</a></a></li><li><a href=#synthesize>@synthesize</a></li><li><a href=#interface--class>@interface & @class</a></li><li><a href=#class-method--instance-method>Class Method & Instance Method</a></li><li><a href=#init-alloc-new>Init, alloc, new</a></li></ul></li><li><a href=#array>Array</a></li><li><a href=#nsdictionary-in-objc>NSDictionary in Objc</a></li><li><a href=#property-in-objc>Property in objc</a></li><li><a href=#property-修饰符>Property 修饰符</a><ul><li><a href=#atomic>atomic</a></li><li><a href=#nonatomic>nonatomic</a></li><li><a href=#copy>copy</a></li><li><a href=#assign>assign</a></li><li><a href=#strong>strong</a></li><li><a href=#weak>weak</a></li></ul></li><li><a href=#初始化-initializationhttpsdeveloperapplecomlibraryarchivedocumentationcocoaconceptualprogrammingwithobjectivecworkingwithobjectsworkingwithobjectshtmlapple_refdocuidtp40011210-ch4-sw1>初始化 <a href=https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/WorkingwithObjects/WorkingwithObjects.html#//apple_ref/doc/uid/TP40011210-CH4-SW1>Initialization</a></a></li><li><a href=#lazy-instantiation--下划线变量>Lazy instantiation & 下划线变量</a><ul><li><a href=#another-example-on-ios面试宝典httpsheron-newlandgithubioassetsknowledgesindexhtml>Another Example on <a href=https://heron-newland.github.io/assets/knowledges/index.html>iOS面试宝典</a></a></li><li><a href=#swift--objc-lazy>Swift & Objc Lazy</a></li><li><a href=#see-more-on>See more on</a></li></ul></li><li><a href=#struct-in-objective-c>Struct in Objective-C</a></li><li><a href=#turn-json-file-into-model-object>Turn JSON File into Model Object</a><ul><li><a href=#array-of-json-objects>Array of JSON Objects</a></li><li><a href=#another-example>Another Example</a></li></ul></li><li><a href=#-isequal-isequalto>==, isEqual, isEqualTo</a><ul><li><a href=#--isequal-objc--swift>==, ===, isEqual: Objc & Swift</a></li></ul></li><li><a href=#category>Category</a><ul><li><a href=#details>Details</a></li><li><a href=#实现>实现</a></li></ul></li><li><a href=#ios-constant---static-nsstring--const-kstr-->iOS Constant - <code>static NSString * const kStr = @""</code></a><ul><li><a href=#首先预处理命令他不是一个常量>首先，预处理命令他不是一个常量！！！！</a></li><li><a href=#用const来定义一个常量>用const来定义一个常量</a></li><li><a href=#一定要同时使用static和const来定义你的变量>一定要同时使用static和const来定义你的变量</a></li><li><a href=#定义工程中的全局变量>定义工程中的全局变量</a></li></ul></li><li><a href=#weakify-和-strongify>@weakify 和 @strongify</a></li><li><a href=#type-size>Type Size</a></li><li><a href=#ternary-operator>Ternary Operator</a></li><li><a href=#block>block</a><ul><li><a href=#read-more>Read More</a></li></ul></li><li><a href=#_nullable>_Nullable</a></li><li><a href=#ns_assume_nonnull_begin-和-ns_assume_nonnull_end><code>NS_ASSUME_NONNULL_BEGIN</code> 和 <code>NS_ASSUME_NONNULL_END</code></a></li><li><a href=#id-type>id type</a><ul><li><a href=#1-静态类型和动态类型>1. 静态类型和动态类型</a></li><li><a href=#2-为什么要有动态类型>2. 为什么要有动态类型?</a></li><li><a href=#3-id数据类型与静态类型>3. id数据类型与静态类型</a></li></ul></li><li><a href=#k-keyword>k Keyword</a></li><li><a href=#yes-no-true-false>YES, NO, true, false</a></li><li><a href=#typedef>typedef</a><ul><li><a href=#ns_enum>NS_ENUM</a></li><li><a href=#ns_options>NS_OPTIONS</a></li><li><a href=#typedef-enum>typedef enum</a></li><li><a href=#difference-between-enum-and-ns_enum>difference between enum and NS_ENUM</a></li></ul></li><li><a href=#nsdictionary-to-class>NSDictionary to Class</a></li><li><a href=#singleton>singleton</a></li><li><a href=#nsuserdefaults>NSUserDefaults</a></li><li><a href=#kvo>KVO</a><ul><li><a href=#kvc>KVC</a></li><li><a href=#isa>isa</a></li><li><a href=#isa-swizzling>isa-swizzling</a></li><li><a href=#method-swizzling>method-swizzling</a></li></ul></li><li><a href=#消息转发---message-forwarding>消息转发 - Message Forwarding</a></li></ul></nav><h2 id=type-unsafe>Type unsafe</h2><ul><li><a href=https://developer.apple.com/documentation/objectivec/1418956-nsobject/1418795-isequal>isEqual</a></li><li><a href=https://developer.apple.com/documentation/objectivec/nsobject/1393823-isequalto>isEqualTo</a></li><li><a href=https://juejin.cn/post/7127912661714468872>OC底层原理之isEqual</a></li><li><a href=https://existorlive.github.io/2020/05/26/isEqual-AND-hash-of-NSObject.html>isEqual</a></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, false <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, nil <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, <span style=color:#ae81ff>0</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, [false isEqual:<span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (nil <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;equal&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=nil-safe-solution>Nil Safe Solution</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>[InterfaceName toGetNSDictionary:self.model.businessInfo<span style=color:#f92672>?:</span><span style=color:#ae81ff>@{}</span>];
</span></span></code></pre></div><p>这行代码的意思是，首先检查 self.model.businessInfo 是否为 nil，如果不是 nil，则使用 self.model.businessInfo，否则返回一个空的 NSDictionary 对象 {}。</p><p>这样写可以避免在访问 self.model.businessInfo 属性时出现空指针异常，因为如果该属性为 nil，则会返回一个空的 NSDictionary 对象，避免了后续的访问出现异常。</p><h2 id=class-in-objective-c>Class in Objective-C</h2><ul><li><a href=https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/Introduction/Introduction.html>Apple Developer: Programming With Objective-C</a></li><li><a href=https://developer.apple.com/library/archive/referencelibrary/GettingStarted/RoadMapOSX/chapters/01_Introduction.html>Apple Developer: Start Developing Mac Apps Today</a></li></ul><h3 id=quickstarthttpswwwtutorialspointcomobjective_cobjective_c_quick_guidehtm><a href=https://www.tutorialspoint.com/objective_c/objective_c_quick_guide.htm>QuickStart</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>@interface</span> <span style=color:#a6e22e>Person</span> : <span style=color:#a6e22e>NSObject</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>strong</span>) NSString <span style=color:#f92672>*</span>name;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>assign</span>) NSInteger age;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>assign</span>) <span style=color:#66d9ef>int</span> birthYear;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>instancetype</span>)<span style=color:#a6e22e>initWithName:</span>(NSString <span style=color:#f92672>*</span>)name <span style=color:#a6e22e>age:</span>(NSInteger)age;
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>void</span>)<span style=color:#a6e22e>sayHello</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@implementation</span> <span style=color:#a6e22e>Person</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@synthesize</span> birthYear;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>instancetype</span>)<span style=color:#a6e22e>initWithName:</span>(NSString <span style=color:#f92672>*</span>)name <span style=color:#a6e22e>age:</span>(NSInteger)age {
</span></span><span style=display:flex><span>    self <span style=color:#f92672>=</span> [super init];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (self) {
</span></span><span style=display:flex><span>        _name <span style=color:#f92672>=</span> name;
</span></span><span style=display:flex><span>        _age <span style=color:#f92672>=</span> age;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> self;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>void</span>)<span style=color:#a6e22e>sayHello</span> {
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;Hello, my name is %@ and I am %ld years old.&#34;</span>, self.name, (<span style=color:#66d9ef>long</span>)self.age);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> main(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span> argv[]) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>@autoreleasepool</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// insert code here...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        NSLog(<span style=color:#e6db74>@&#34;Hello, World!&#34;</span>);
</span></span><span style=display:flex><span>        Person <span style=color:#f92672>*</span>person <span style=color:#f92672>=</span> [[Person alloc] initWithName:<span style=color:#e6db74>@&#34;John Doe&#34;</span> age:<span style=color:#ae81ff>25</span>];
</span></span><span style=display:flex><span>        person.birthYear <span style=color:#f92672>=</span> <span style=color:#ae81ff>2022</span>;
</span></span><span style=display:flex><span>        [person sayHello];
</span></span><span style=display:flex><span>        NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, person.birthYear);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=synthesize>@synthesize</h3><p>@synthesize height;</p><p>@synthesize is an Objective-C directive used to automatically generate getter and setter methods for a class property.</p><p>Before the release of Objective-C 2.0, developers had to write both the getter and setter methods themselves, which could be quite verbose and repetitive. However, with @synthesize, the compiler can generate these methods automatically based on the declared property, greatly simplifying the code.</p><p>For example, suppose you have a property height declared in a class Person. Instead of writing the getter and setter methods yourself, you can simply write:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>@implementation</span> <span style=color:#a6e22e>Person</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@synthesize</span> height;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span></code></pre></div><p>This will automatically generate the getter and setter methods for the height property.</p><p>Note that with the release of Objective-C 2.0, @synthesize is no longer strictly necessary. Instead, you can use the @property directive to declare the property and the compiler will automatically generate the getter and setter methods by default. However, @synthesize can still be useful in some cases, such as when you need to customize the behavior of the generated methods.</p><h3 id=interface--class>@interface & @class</h3><p>在 Objective-C 中，@interface 是用来声明一个类的接口部分的关键字。它通常用于头文件（.h 文件）中，在其中定义了类的属性、方法和实例变量的声明。</p><p>@class 是另一个关键字，用于在接口部分中声明一个类的名称，但不提供详细的类定义。它通常用于解决循环引用的问题。当多个类相互引用时，可以使用 @class 来提前声明类的名称，从而避免循环引用导致的编译错误。</p><p>例如，假设有两个类 A 和 B，彼此相互引用。在 A 的头文件中，可以使用 @class B; 来提前声明类 B 的名称，表示 A 类中会使用到 B 类。然后，在 A 类的实现文件中（.m 文件）或者需要访问 B 类的地方，再导入 B 类的头文件。</p><p>总之，@interface 用于声明一个类的接口部分，而 @class 用于提前声明一个类的名称以解决循环引用的问题。</p><h3 id=class-method--instance-method>Class Method & Instance Method</h3><h3 id=init-alloc-new>Init, alloc, new</h3><p>在 Objective-C 中，new 和 alloc init 都是用于创建对象的方式，但它们有一些区别。</p><p>alloc init: 这是最常见的创建对象的方式。首先，使用 alloc 方法为对象分配内存空间，然后使用 init 方法进行初始化。例如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>MyClass <span style=color:#f92672>*</span>myObject <span style=color:#f92672>=</span> [[MyClass alloc] init];
</span></span></code></pre></div><p>new: new 是一个便捷方法，它一次性完成了对象的内存分配和初始化。它相当于调用 alloc 方法为对象分配内存空间，然后调用 init 方法进行初始化，并返回已初始化的对象。例如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>MyClass <span style=color:#f92672>*</span>myObject <span style=color:#f92672>=</span> [MyClass new];
</span></span></code></pre></div><p>尽管 new 是一种更简洁的写法，但实际上它只是 alloc init 的简化形式。因此，从功能上来说，它们是等效的。你可以根据个人偏好选择使用哪种方式。</p><p>需要注意的是，使用 alloc init 或 new 创建的对象，都需要在不再使用时手动释放内存，通过调用 release 方法或使用自动引用计数（ARC）来管理内存。</p><h2 id=array>Array</h2><p>在Objective-C中，@ 符号在不同的上下文中有不同的作用。在这个特定的代码行中，@ 符号表示了一个 Objective-C 字符串字面量。</p><p>[self.sections addObject:@[modelToBeAddedInArray]] 这行代码将 modelToBeAddedInArray 对象添加到 self.sections 数组中。@[] 表示一个空的 NSArray 字面量，而 @[modelToBeAddedInArray] 则表示一个包含 modelToBeAddedInArray 对象的 NSArray。</p><p>通过使用 @ 符号创建 NSArray 或 NSDictionary 等集合类型的字面量，可以更方便地创建和初始化这些集合对象。</p><h2 id=nsdictionary-in-objc>NSDictionary in Objc</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSDictionary <span style=color:#f92672>*</span>dictionary <span style=color:#f92672>=</span> <span style=color:#ae81ff>@{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>@&#34;name&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>@&#34;John&#34;</span>, 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>@&#34;age&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>@30</span>, 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>@&#34;gender&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>@&#34;male&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>}</span>;
</span></span></code></pre></div><p>这个 NSDictionary 包含了三个键值对，分别是 &ldquo;name&rdquo;、&ldquo;age&rdquo; 和 &ldquo;gender&rdquo;。其中，键都是 NSString 类型，而值可以是任意的对象，例如这里的 @&ldquo;John&rdquo; 是一个 NSString 对象，@30 是一个 NSNumber 对象，@&ldquo;male&rdquo; 也是一个 NSString 对象。</p><p>你可以通过 key 来获取对应的 value，例如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSString <span style=color:#f92672>*</span>name <span style=color:#f92672>=</span> [dictionary objectForKey:<span style=color:#e6db74>@&#34;name&#34;</span>];
</span></span><span style=display:flex><span>NSNumber <span style=color:#f92672>*</span>age <span style=color:#f92672>=</span> [dictionary objectForKey:<span style=color:#e6db74>@&#34;age&#34;</span>];
</span></span><span style=display:flex><span>NSString <span style=color:#f92672>*</span>gender <span style=color:#f92672>=</span> [dictionary objectForKey:<span style=color:#e6db74>@&#34;gender&#34;</span>];
</span></span></code></pre></div><p>这样就分别取到了对应 key 的 value 值。如果 key 不存在，那么 objectForKey 方法将返回 nil。</p><p>除了使用 objectForKey 方法外，还可以使用下标语法来访问 NSDictionary 中的值，例如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSString <span style=color:#f92672>*</span>name <span style=color:#f92672>=</span> dictionary[<span style=color:#e6db74>@&#34;name&#34;</span>];
</span></span><span style=display:flex><span>NSNumber <span style=color:#f92672>*</span>age <span style=color:#f92672>=</span> dictionary[<span style=color:#e6db74>@&#34;age&#34;</span>];
</span></span><span style=display:flex><span>NSString <span style=color:#f92672>*</span>gender <span style=color:#f92672>=</span> dictionary[<span style=color:#e6db74>@&#34;gender&#34;</span>];
</span></span></code></pre></div><h2 id=property-in-objc>Property in objc</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>@interface</span> <span style=color:#a6e22e>MyObject</span> : <span style=color:#a6e22e>NSObject</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> memberVar1; <span style=color:#75715e>// 显式地声明实例变量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>id</span>  memberVar2;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@interface</span> <span style=color:#a6e22e>HotDiscussionModel</span> : <span style=color:#a6e22e>NSObject</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>assign</span>) NSString <span style=color:#f92672>*</span>guid;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>assign</span>) NSString <span style=color:#f92672>*</span>picUrl;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>assign</span>) NSString <span style=color:#f92672>*</span>hotLink;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span></code></pre></div><p>这两段代码的区别在于定义实例变量的方式不同。</p><p>第一段代码在 @interface 语句中声明了实例变量 memberVar1 和 memberVar2。这种方式是早期 Objective-C 的写法，在现代 Objective-C 中不太常见了。</p><p>而第二段代码则使用了现代 Objective-C 的属性声明方式，使用 @property 来定义属性，不需要显式地声明实例变量。编译器会自动为属性生成对应的实例变量 _guid、_picUrl 和 _hotLink。</p><p>需要注意的是，在第二段代码中，属性的 assign 关键字表示该属性的 setter 方法会直接将传入的参数赋值给实例变量，不会进行内存管理。而 retain 和 copy 则会自动处理内存管理，retain 表示 setter 方法会对传入的对象进行引用计数 +1 的操作，而 copy 表示 setter 方法会对传入的对象进行一份拷贝，然后进行引用计数的操作。通常情况下，对于对象类型的属性，我们应该使用 copy 或 strong 来进行内存管理，而对于基本数据类型的属性，我们可以使用 assign。</p><h2 id=property-修饰符>Property 修饰符</h2><blockquote><p><a href=https://www.jianshu.com/p/4fb51144d4ca>iOS 中定义属性时的atomic、nonatomic、copy、assign、strong、weak几个特性的区别</a></p></blockquote><h3 id=atomic>atomic</h3><ul><li>默认属性。</li><li>当前进程进行到一半，其他线程来访问当前线程，可以保证先执行完毕当前线程。</li><li>只是保证setter/getter 完整，不是线程安全。</li></ul><h3 id=nonatomic>nonatomic</h3><ul><li>非默认属性。</li><li>两个线程同时访问同一个属性将会导致无法预计的结果。</li><li>优点是程序运行速度快。</li></ul><h3 id=copy>copy</h3><ul><li>是owner，不是reference（引用）。当对象可变时，可设置为copy，用于获取此时值的副本。</li><li>新的对象引用计数为1，与原始对象引用计数无关，且原始对象引用计数不会改变。</li><li>使用copy创建的新对象也是强引用，使用完成后需要负责释放该对象。</li><li>copy特性可以减少对象对上下文的依赖。新对象、原始对象中任一对象的值改变不会影响另一对象的值。</li><li>要想设置该对象的特性为copy，该对象必须遵守NSCopying协议，Foundation类默认实现了NSCopying协议，所以只需要为自定义的类实现该协议即可。更全面了解NSCopying协议，查看 深复制、浅复制、copy、mutableCopy 一文。</li></ul><h3 id=assign>assign</h3><ul><li>与copy相反，只是reference，不是owner。只返回指针。</li><li>用于float、int、BOOL等类型。</li><li>释放后再发送消息会导致程序崩溃。</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>assign</span>) <span style=color:#66d9ef>BOOL</span> isSystemNotificationOn;
</span></span></code></pre></div><h3 id=strong>strong</h3><ul><li>默认属性</li><li>strong = retain iOS引入ARC后，用strong替代了retain。</li><li>创建一个强引用的指针，引用对象引用计数加1。</li><li>strong特性表示两个对象内存地址相同（建立一个指针，进行指针拷贝），内容会一直保持相同，直到更改一方内存地址，或将其设置为nil。</li><li>如果有多个对象同时引用一个属性，任一对象对该属性的修改都会影响其他对象获取的值。</li><li>所有实例变量、局部变量默认都是strong。</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>strong</span>) UITableView <span style=color:#f92672>*</span>tableView;
</span></span></code></pre></div><h3 id=weak>weak</h3><ul><li>只是reference，不是owner。即引用计数不会加1。</li><li>可将weak对象设为nil，向nil发送消息，什么都不会执行，程序也不会崩溃。</li><li>代理使用weak。delegate几乎一直own代理对象，所以代理对象应该对代理使用weak，否则会形成循环引用（retain cycle）。但也有例外，如果代理对象的生命周期比代理短，代理对象也可以使用strong。</li><li>IBOutlet常用weak。</li></ul><blockquote><p>关于strong和weak对比的一个形象例子：</p><p>假设对象是一条小狗，小狗想跑走（be deallocated)。</p><p>strong类型就像是拴狗的绳子，只要有一条绳子栓住狗，它就不能跑走，如果有五条绳子拴着同一条狗（五个strong类型指向同一个对象），只有当五条绳子都释放狗才可以跑走。</p><p>weak类型就像是小孩子看着小狗说：看这里有小狗。只要还有绳子拴着小狗，小孩子们就可以继续指着小狗说：看这里有小狗。当绳子释放了的时候，不管有多少小孩子依旧在指着小狗说：看这里的小狗。小狗都会跑掉。</p><p>当最后一个strong指针不再指向这个对象，这个对象就会被释放，此时，所有指向这个对象的weak指针都将被清空。</p></blockquote><h2 id=初始化-initializationhttpsdeveloperapplecomlibraryarchivedocumentationcocoaconceptualprogrammingwithobjectivecworkingwithobjectsworkingwithobjectshtmlapple_refdocuidtp40011210-ch4-sw1>初始化 <a href=https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/WorkingwithObjects/WorkingwithObjects.html#//apple_ref/doc/uid/TP40011210-CH4-SW1>Initialization</a></h2><p>Use new to Create an Object If No Arguments Are Needed for Initialization
It’s also possible to create an instance of a class using the new class method. This method is provided by NSObject and doesn’t need to be overridden in your own subclasses.</p><p>It’s effectively the same as calling alloc and init with no arguments:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>XYZObject <span style=color:#f92672>*</span>object <span style=color:#f92672>=</span> [XYZObject new];
</span></span><span style=display:flex><span><span style=color:#75715e>// is effectively the same as:
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>XYZObject <span style=color:#f92672>*</span>object <span style=color:#f92672>=</span> [[XYZObject alloc] init];
</span></span></code></pre></div><h2 id=lazy-instantiation--下划线变量>Lazy instantiation & 下划线变量</h2><blockquote><p><a href=https://www.jianshu.com/p/986adc6fe3ca>Objective-C 懒加载没有调用？</a></p></blockquote><p>总结：self.对属性的get和set方法间接调用，下划线_是直接对实例变量操作。</p><blockquote><p>前面已经说到，在iOS 5之后，使用<code>@property</code>定义一个属性后，系统会默认生成<code>getter</code>和<code>setter</code>方法。我们申明了一个属性，但并不是立即就要使用这个对象，没必要把所有的属性都放在<code>viewDidLoad</code>方法中初始化，等到要使用时再加载(初始化)。</p></blockquote><p>（1）、当开发者使用懒加载本质就是重写了 <code>getter()</code> 方法；</p><p>（2）、懒加载在加载时必须判空；</p><p>（3）、懒加载判空必须使用下划线，如下面代码，Xcode 100% 会报错的，前面已经说明，self 就是调用了 setter 跟 getter 方法，懒加载本质就是重写了 getter 方法，但在此处属性本身还没初始化,是 nil, 但是 getter 返回的也是 nil, 那在判断时就会进入死循环；</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>//错误的懒加载示范一
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>-(NSArray<span style=color:#f92672>*</span>)<span style=color:#a6e22e>PageddatafromServerList</span> {   
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(self.PageddatafromServerList <span style=color:#f92672>==</span> nil)   {     
</span></span><span style=display:flex><span>        self.PageddatafromServerList <span style=color:#f92672>=</span> [NSArray array];    
</span></span><span style=display:flex><span>    }  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> self.PageddatafromServerList;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//错误的懒加载示范二
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>-(NSArray<span style=color:#f92672>*</span>)<span style=color:#a6e22e>PageddatafromServerList</span> {   
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(self.PageddatafromServerList) <span style=color:#75715e>//此处一定要判空   
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    {     
</span></span><span style=display:flex><span>        self.PageddatafromServerList <span style=color:#f92672>=</span> [NSArray array];    
</span></span><span style=display:flex><span>    }  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> self.PageddatafromServerList;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//正确的懒加载方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>- (NSArray <span style=color:#f92672>*</span>)<span style=color:#a6e22e>DepartmentArray</span> {   
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(_DepartmentArray <span style=color:#f92672>==</span> nil) {      
</span></span><span style=display:flex><span>        _DepartmentArray <span style=color:#f92672>=</span> [NSArray array];   
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> _DepartmentArray;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><img src=https://upload-images.jianshu.io/upload_images/1214383-1d112281de77c800.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/651/format/webp alt=懒加载问题代码></p><blockquote><p>分析：最上面贴出的代码出现的原因：</p><p>由于这个写这个代码的哥们使用了懒加载，而懒加载本质上是重写了属性的 <code>getter</code> 方法，本文第二条也说明了 <code>self.</code> 和 <code>_</code> 的区别，所以在赋值时使用 <code>_dataArray</code>，就没有调 <code>dataArray</code> 的 <code>getter</code> 方法，懒加载根本就没有调！！！所以出现的情况就是给 <code>dataArray</code> 赋值后依旧是 <code>nil</code>！</p><p>直接就举个🌰来说明吧：我买了个超级省电的台灯，回家后我给台灯通上电后发现怎么折腾这个台灯都不亮，为什么呢？因为我没有摁台灯的开关！！</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>// 那么懒加载的正确打开方式是怎样的呢？请看代码：
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>@interface</span> <span style=color:#a6e22e>EOCClass</span> : <span style=color:#a6e22e>NSObject</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>strong</span>, <span style=color:#66d9ef>nonatomic</span>) NSArray <span style=color:#f92672>*</span>LazyLoading;
</span></span><span style=display:flex><span>-(<span style=color:#66d9ef>void</span>)<span style=color:#a6e22e>LazyLoadingData</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>-</span>(<span style=color:#66d9ef>void</span>)LazyLoadingData {
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;_LazyLoading============%@&#34;</span>,_LazyLoading);    
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;self.LazyLoading=============%@&#34;</span>,self.LazyLoading);    
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;=============%@&#34;</span>,[self LazyLoading]);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>-</span>(NSArray<span style=color:#f92672>*</span>)LazyLoading {   
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>_LazyLoading) {     
</span></span><span style=display:flex><span>        _LazyLoading<span style=color:#f92672>=</span> [NSArray array];   
</span></span><span style=display:flex><span>    }  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> _LazyLoading;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><img src=https://upload-images.jianshu.io/upload_images/1214383-624cf0347e44f040.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/593/format/webp alt=懒加载图片></p><blockquote><p>那么，通过上面的代码，可以看出，使用了懒加载后，当要使用这个对象时可以用<code>self.</code> 调用该对象或者直接调用这个对象的 <code>getter</code> 方法，如果用下划线调用实例变量那么懒加载就没有调用，最终造成的结果就是赋值了也是 <code>nil</code>;</p></blockquote><h3 id=another-example-on-ios面试宝典httpsheron-newlandgithubioassetsknowledgesindexhtml>Another Example on <a href=https://heron-newland.github.io/assets/knowledges/index.html>iOS面试宝典</a></h3><blockquote><p><a href=https://heron-newland.github.io/assets/knowledges/%E4%BB%80%E4%B9%88%E6%98%AF%E6%87%92%E5%8A%A0%E8%BD%BD.html>什么是懒加载</a></p><p>懒汉模式，只在用到的时候才去初始化，也可以理解成延时加载,一般懒加载写在getter方法中。我觉得最好也最简单的一个列子就是 <code>tableView</code> 中图片的加载显示了。一个延时载，避免内存过高，一个异步加载，避免线程堵塞。</p></blockquote><h3 id=swift--objc-lazy>Swift & Objc Lazy</h3><p><a href=https://blog.csdn.net/I_HOPE_SOAR/article/details/121306121>objective-c和swift中懒加载的区别</a></p><p>oc中懒加载的写法就是，如果一个变量为空，则进行一定操作，否则return原来的值</p><p>而swift中只用写一个lazy标识符,swift中的懒加载只有第一次调用此变量时才执行闭包中的内容，不论是否为空，后面都不会执行了。</p><p>所以两者的区别就在于，如果调用了一次oc中的懒加载，再把变量设置为空，第二次还是会进入懒加载。</p><p>而swift语言中，调用了一次懒加载，再把变量设置为空，第二次就不会进入懒加载了。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#75715e>//swift</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>Foundation</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Test</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> name: String
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>lazy</span> <span style=color:#66d9ef>var</span> greeting: String? = {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;hello&#34;</span>
</span></span><span style=display:flex><span>    }()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>lazy</span> <span style=color:#66d9ef>var</span> eatting: String = {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;rice&#34;</span>
</span></span><span style=display:flex><span>    }()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>init</span>(name: String) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>self</span>.name = name
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> test = Test(name: <span style=color:#e6db74>&#34;init&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> a = test.greeting<span style=color:#75715e>//第一次调用</span>
</span></span><span style=display:flex><span>print(a!)<span style=color:#75715e>//输出hello</span>
</span></span><span style=display:flex><span>test.greeting = <span style=color:#66d9ef>nil</span><span style=color:#75715e>//设置为空</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> b = test.greeting<span style=color:#75715e>//第二次调用</span>
</span></span><span style=display:flex><span>print(b)<span style=color:#75715e>//输出nil</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>//objectivec
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#import &lt;Foundation/Foundation.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@interface</span> <span style=color:#a6e22e>Test</span> : <span style=color:#a6e22e>NSObject</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>) NSString <span style=color:#f92672>*</span>name;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@implementation</span> <span style=color:#a6e22e>Test</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//lazy load
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>- (NSString <span style=color:#f92672>*</span>)<span style=color:#a6e22e>name</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>_name) {
</span></span><span style=display:flex><span>        _name <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;hello&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> _name;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>void</span>)<span style=color:#a6e22e>printt</span> {
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;%@&#34;</span>,_name);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> main(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span> argv[]) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>@autoreleasepool</span> {
</span></span><span style=display:flex><span>        Test <span style=color:#f92672>*</span>test <span style=color:#f92672>=</span> [[Test alloc] init];
</span></span><span style=display:flex><span>        NSLog(<span style=color:#e6db74>@&#34;%@&#34;</span>,test.name);<span style=color:#75715e>//第一次调用，输出hello
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        test.name <span style=color:#f92672>=</span> nil;
</span></span><span style=display:flex><span>        NSLog(<span style=color:#e6db74>@&#34;%@&#34;</span>,test.name);<span style=color:#75715e>//第二次调用，输出hello两次进入懒加载
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=see-more-on>See more on</h3><ul><li><a href=https://blog.csdn.net/yxys01/article/details/51489938>Objective-C学习之懒加载（延迟加载）</a></li><li><a href=https://stackoverflow.com/questions/11769562/lazy-instantiation-in-objective-c-iphone-development>Lazy instantiation in Objective-C/ iPhone development</a></li></ul><h2 id=struct-in-objective-c>Struct in Objective-C</h2><ul><li><a href=https://blog.csdn.net/srn214/article/details/47788231>OC中定义了一个结构体(struct)，设置结构体的值</a></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>// main.m 文件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#import &lt;Foundation/Foundation.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>#import &#34;Dog.h&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>#import &#34;Person.h&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>#import &#34;Student.h&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span> argv[]) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>@autoreleasepool</span> {
</span></span><span style=display:flex><span>        Person <span style=color:#f92672>*</span>p1 <span style=color:#f92672>=</span> [[Person alloc] init];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 给对象中的结构体(struct)赋值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// 如果直接用c语言的方式直接赋值就会报错，如s-&gt;birthday={1990,12,11};就会抛出错误
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// 声明并初始化一个struct类型临时变量，再整个赋值给birthday成员。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        Date d <span style=color:#f92672>=</span> {<span style=color:#ae81ff>2015</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>22</span>};
</span></span><span style=display:flex><span>        p1.birthday <span style=color:#f92672>=</span> d;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Person.h 文件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#import &lt;Foundation/Foundation.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>// 生日
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> year; <span style=color:#75715e>// 年
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>int</span> month; <span style=color:#75715e>// 月
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>int</span> day; <span style=color:#75715e>// 日
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>} Date;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 性别
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>enum</span> {
</span></span><span style=display:flex><span>    XingBieMan,
</span></span><span style=display:flex><span>    XingBieWoman
</span></span><span style=display:flex><span>} XingBie;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@interface</span> <span style=color:#a6e22e>Person</span> : <span style=color:#a6e22e>NSObject</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 姓名的setter和getter
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>retain</span>) NSString <span style=color:#f92672>*</span>name;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 生日的setter和getter
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>assign</span>) Date birthday;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 年龄的setter和getter
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>assign</span>) <span style=color:#66d9ef>int</span> age;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 性别
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>assign</span>) XingBie sex;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 身高
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>assign</span>) <span style=color:#66d9ef>double</span> height;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 体重
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>assign</span>) <span style=color:#66d9ef>double</span> weight;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span></code></pre></div><h2 id=turn-json-file-into-model-object>Turn JSON File into Model Object</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;John Doe&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;age&#34;</span>: <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>// Person.h 文件内容：
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#import &lt;Foundation/Foundation.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@interface</span> <span style=color:#a6e22e>Person</span> : <span style=color:#a6e22e>NSObject</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>strong</span>) NSString <span style=color:#f92672>*</span>name;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>assign</span>) NSInteger age;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>instancetype</span>)<span style=color:#a6e22e>initWithDictionary:</span>(NSDictionary <span style=color:#f92672>*</span>)dictionary;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>// Person.m 文件内容：
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#import &#34;Person.h&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@implementation</span> <span style=color:#a6e22e>Person</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>instancetype</span>)<span style=color:#a6e22e>initWithDictionary:</span>(NSDictionary <span style=color:#f92672>*</span>)dictionary {
</span></span><span style=display:flex><span>    self <span style=color:#f92672>=</span> [super init];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (self) {
</span></span><span style=display:flex><span>        _name <span style=color:#f92672>=</span> dictionary[<span style=color:#e6db74>@&#34;name&#34;</span>];
</span></span><span style=display:flex><span>        _age <span style=color:#f92672>=</span> [dictionary[<span style=color:#e6db74>@&#34;age&#34;</span>] integerValue];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> self;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>// main.m 文件内容：
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#import &lt;Foundation/Foundation.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>#import &#34;Person.h&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span> argv[]) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>@autoreleasepool</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 1. 读取 JSON 文件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// If you use Xcode CLI
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        NSString <span style=color:#f92672>*</span>filePath <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;/Users/frank/Example/CLITesting/CLITesting/person.json&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#75715e>// If you use Xcode App
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// NSString *filePath = [[NSBundle mainBundle] pathForResource:@&#34;data&#34; ofType:@&#34;json&#34;];
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        NSData <span style=color:#f92672>*</span>jsonData <span style=color:#f92672>=</span> [NSData dataWithContentsOfFile:filePath];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//        NSLog(@&#34;%@&#34;, jsonData);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// 2. 使用 NSJSONSerialization 将 JSON 数据转换为字典
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        NSError <span style=color:#f92672>*</span>error;
</span></span><span style=display:flex><span>        NSDictionary <span style=color:#f92672>*</span>jsonDictionary <span style=color:#f92672>=</span> [NSJSONSerialization
</span></span><span style=display:flex><span>                                        JSONObjectWithData:jsonData
</span></span><span style=display:flex><span>                                        options:kNilOptions
</span></span><span style=display:flex><span>                                        error:<span style=color:#f92672>&amp;</span>error];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 3. 判断是否转换成功
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (error) {
</span></span><span style=display:flex><span>            NSLog(<span style=color:#e6db74>@&#34;Error converting JSON to NSDictionary: %@&#34;</span>, error.localizedDescription);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 4. 使用字典初始化 Person 对象
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            Person <span style=color:#f92672>*</span>person <span style=color:#f92672>=</span> [[Person alloc] initWithDictionary:jsonDictionary];
</span></span><span style=display:flex><span>            NSLog(<span style=color:#e6db74>@&#34;Person name: %@, age: %ld&#34;</span>, person.name, (<span style=color:#66d9ef>long</span>)person.age);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=array-of-json-objects>Array of JSON Objects</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>[
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;John Doe&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;age&#34;</span>: <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Frank Doe&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;age&#34;</span>: <span style=color:#ae81ff>330</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>// 1. 读取 JSON 文件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>NSString <span style=color:#f92672>*</span>filePath <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;/Users/frank/Example/CLITesting/CLITesting/person.json&#34;</span>;
</span></span><span style=display:flex><span>NSData <span style=color:#f92672>*</span>jsonData <span style=color:#f92672>=</span> [NSData dataWithContentsOfFile:filePath];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//        NSLog(@&#34;%@&#34;, jsonData);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 2. 使用 NSJSONSerialization 将 JSON 数据转换为字典
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>NSError <span style=color:#f92672>*</span>error;
</span></span><span style=display:flex><span>NSDictionary <span style=color:#f92672>*</span>jsonDictionary <span style=color:#f92672>=</span> [NSJSONSerialization
</span></span><span style=display:flex><span>                                JSONObjectWithData:jsonData
</span></span><span style=display:flex><span>                                options:kNilOptions
</span></span><span style=display:flex><span>                                error:<span style=color:#f92672>&amp;</span>error];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 3. 判断是否转换成功
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (error) {
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;Error converting JSON to NSDictionary: %@&#34;</span>, error.localizedDescription);
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 4. 使用字典初始化 Person 对象
</span></span></span><span style=display:flex><span><span style=color:#75715e>//            Person *person = [[Person alloc] initWithDictionary:jsonDictionary];
</span></span></span><span style=display:flex><span><span style=color:#75715e>//            NSLog(@&#34;Person name: %@, age: %ld&#34;, person.name, (long)person.age);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    NSMutableArray <span style=color:#f92672>*</span>personArray <span style=color:#f92672>=</span> [NSMutableArray array];
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;%@&#34;</span>, jsonDictionary);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (NSDictionary <span style=color:#f92672>*</span>dict <span style=color:#66d9ef>in</span> jsonDictionary) {
</span></span><span style=display:flex><span>        Person <span style=color:#f92672>*</span>person <span style=color:#f92672>=</span> [[Person alloc] init];
</span></span><span style=display:flex><span>        person.age <span style=color:#f92672>=</span> [dict[<span style=color:#e6db74>@&#34;age&#34;</span>] integerValue];
</span></span><span style=display:flex><span>        person.name <span style=color:#f92672>=</span> dict[<span style=color:#e6db74>@&#34;name&#34;</span>];
</span></span><span style=display:flex><span>        [personArray addObject:person];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;%@&#34;</span>, personArray);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=another-example>Another Example</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e>//  main.m
</span></span></span><span style=display:flex><span><span style=color:#75715e>//  CLITesting
</span></span></span><span style=display:flex><span><span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e>//  Created by hb24155 on 3/30/23.
</span></span></span><span style=display:flex><span><span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#import &lt;Foundation/Foundation.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@interface</span> <span style=color:#a6e22e>HotDetail</span> : <span style=color:#a6e22e>NSObject</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>strong</span>) NSString <span style=color:#f92672>*</span>contentId;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>strong</span>) NSArray<span style=color:#f92672>&lt;</span>NSString <span style=color:#f92672>*&gt;</span> <span style=color:#f92672>*</span>headImageList;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>strong</span>) NSString <span style=color:#f92672>*</span>pvCount;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>strong</span>) NSString <span style=color:#f92672>*</span>iconUrl;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>strong</span>) NSString <span style=color:#f92672>*</span>title;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>strong</span>) NSString <span style=color:#f92672>*</span>jumpUrl;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>instancetype</span>)<span style=color:#a6e22e>initWithDictionary:</span>(NSDictionary <span style=color:#f92672>*</span>)dictionary;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@implementation</span> <span style=color:#a6e22e>HotDetail</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>instancetype</span>)<span style=color:#a6e22e>initWithDictionary:</span>(NSDictionary <span style=color:#f92672>*</span>)dictionary {
</span></span><span style=display:flex><span>    self <span style=color:#f92672>=</span> [super init];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (self) {
</span></span><span style=display:flex><span>        _contentId <span style=color:#f92672>=</span> dictionary[<span style=color:#e6db74>@&#34;contentId&#34;</span>];
</span></span><span style=display:flex><span>        _headImageList <span style=color:#f92672>=</span> dictionary[<span style=color:#e6db74>@&#34;headImageList&#34;</span>];
</span></span><span style=display:flex><span>        _pvCount <span style=color:#f92672>=</span> dictionary[<span style=color:#e6db74>@&#34;pvCount&#34;</span>];
</span></span><span style=display:flex><span>        _iconUrl <span style=color:#f92672>=</span> dictionary[<span style=color:#e6db74>@&#34;iconUrl&#34;</span>];
</span></span><span style=display:flex><span>        _title <span style=color:#f92672>=</span> dictionary[<span style=color:#e6db74>@&#34;title&#34;</span>];
</span></span><span style=display:flex><span>        _jumpUrl <span style=color:#f92672>=</span> dictionary[<span style=color:#e6db74>@&#34;jumpUrl&#34;</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> self;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@interface</span> <span style=color:#a6e22e>HotDiscussion</span> : <span style=color:#a6e22e>NSObject</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>strong</span>) NSString <span style=color:#f92672>*</span>guid;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>strong</span>) NSString <span style=color:#f92672>*</span>picUrl;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>strong</span>) NSString <span style=color:#f92672>*</span>hotLink;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>strong</span>) NSArray<span style=color:#f92672>&lt;</span>HotDetail <span style=color:#f92672>*&gt;</span> <span style=color:#f92672>*</span>hotDetailList;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>instancetype</span>)<span style=color:#a6e22e>initWithDictionary:</span>(NSDictionary <span style=color:#f92672>*</span>)dictionary;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@implementation</span> <span style=color:#a6e22e>HotDiscussion</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>instancetype</span>)<span style=color:#a6e22e>initWithDictionary:</span>(NSDictionary <span style=color:#f92672>*</span>)dictionary {
</span></span><span style=display:flex><span>    self <span style=color:#f92672>=</span> [super init];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (self) {
</span></span><span style=display:flex><span>        _guid <span style=color:#f92672>=</span> dictionary[<span style=color:#e6db74>@&#34;guid&#34;</span>];
</span></span><span style=display:flex><span>        _picUrl <span style=color:#f92672>=</span> dictionary[<span style=color:#e6db74>@&#34;picUrl&#34;</span>];
</span></span><span style=display:flex><span>        _hotLink <span style=color:#f92672>=</span> dictionary[<span style=color:#e6db74>@&#34;hotLink&#34;</span>];
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        NSMutableArray <span style=color:#f92672>*</span>details <span style=color:#f92672>=</span> [NSMutableArray array];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (NSDictionary <span style=color:#f92672>*</span>detailDict <span style=color:#66d9ef>in</span> dictionary[<span style=color:#e6db74>@&#34;hotDetailList&#34;</span>]) {
</span></span><span style=display:flex><span>            HotDetail <span style=color:#f92672>*</span>detail <span style=color:#f92672>=</span> [[HotDetail alloc] initWithDictionary:detailDict];
</span></span><span style=display:flex><span>            [details addObject:detail];
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        _hotDetailList <span style=color:#f92672>=</span> [details <span style=color:#66d9ef>copy</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> self;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> main(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span> argv[]) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>@autoreleasepool</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// insert code here...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        NSLog(<span style=color:#e6db74>@&#34;Hello, World!&#34;</span>);
</span></span><span style=display:flex><span>        NSString <span style=color:#f92672>*</span>jsonString <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;{</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>hotDiscussion</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: {</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>guid</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>do mollit pro</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>picUrl</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>adipisicing deserunt ea ex</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>hotLink</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>occaecat</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>hotDetailList</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: [{</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>contentId</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>quis mollit sit</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>headImageList</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: [</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>labore deserunt sint</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>cup</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>aliqua sint magna</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>],</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>pvCount</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>laboris id adipisicing</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>iconUrl</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>ut non</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>title</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>aute exercitation nisi tempor</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>jumpUrl</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>ut ut eu cupidatat</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>},{</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>contentId</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>nostrud exercitation quis cupidatat eiusmod</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>headImageList</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: [</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>incididunt sunt</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>exercitation enim officia aute</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>],</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>pvCount</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>labore</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>iconUrl</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>sed tempor magna nulla</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>title</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>in amet dolor minim</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>jumpUrl</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>amet</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>}]}}&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        NSData <span style=color:#f92672>*</span>jsonData <span style=color:#f92672>=</span> [jsonString dataUsingEncoding:NSUTF8StringEncoding];
</span></span><span style=display:flex><span>        NSError <span style=color:#f92672>*</span>error;
</span></span><span style=display:flex><span>        NSDictionary <span style=color:#f92672>*</span>jsonDict <span style=color:#f92672>=</span> [NSJSONSerialization JSONObjectWithData:jsonData options:NSJSONReadingMutableContainers error:<span style=color:#f92672>&amp;</span>error];
</span></span><span style=display:flex><span>        NSLog(<span style=color:#e6db74>@&#34;%@&#34;</span>, jsonDict);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e> &#34;hotDiscussion&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#75715e>     &#34;guid&#34;: &#34;do mollit pro&#34;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>     &#34;picUrl&#34;: &#34;adipisicing deserunt ea ex&#34;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>     &#34;hotLink&#34;: &#34;occaecat&#34;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>     &#34;hotDetailList&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#75715e>         {
</span></span></span><span style=display:flex><span><span style=color:#75715e>             &#34;contentId&#34;: &#34;quis mollit sit&#34;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>             &#34;headImageList&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#75715e>                 &#34;labore deserunt sint&#34;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>                 &#34;cup&#34;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>                 &#34;aliqua sint magna&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>             ],
</span></span></span><span style=display:flex><span><span style=color:#75715e>             &#34;pvCount&#34;: &#34;laboris id adipisicing&#34;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>             &#34;iconUrl&#34;: &#34;ut non&#34;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>             &#34;title&#34;: &#34;aute exercitation nisi tempor&#34;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>             &#34;jumpUrl&#34;: &#34;ut ut eu cupidatat&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>         },
</span></span></span><span style=display:flex><span><span style=color:#75715e>         {
</span></span></span><span style=display:flex><span><span style=color:#75715e>             &#34;contentId&#34;: &#34;nostrud exercitation quis cupidatat eiusmod&#34;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>             &#34;headImageList&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#75715e>                 &#34;incididunt sunt&#34;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>                 &#34;exercitation enim officia aute&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>             ],
</span></span></span><span style=display:flex><span><span style=color:#75715e>             &#34;pvCount&#34;: &#34;labore&#34;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>             &#34;iconUrl&#34;: &#34;sed tempor magna nulla&#34;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>             &#34;title&#34;: &#34;in amet dolor minim&#34;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>             &#34;jumpUrl&#34;: &#34;amet&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>         },
</span></span></span><span style=display:flex><span><span style=color:#75715e>     ]
</span></span></span><span style=display:flex><span><span style=color:#75715e> }
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span></code></pre></div><h2 id=-isequal-isequalto>==, isEqual, isEqualTo</h2><blockquote><p><a href=https://stackoverflow.com/questions/7096691/difference-between-isequalto-and-isequal>Difference between isEqualTo: and isEqual:</a></p></blockquote><p>isEqual: is part of the NSObject protocol and is meant for comparing objects.</p><p>isEqual: 方法是 NSObject 类的一个方法，它用于比较两个对象的内容是否相等。具体来说，它比较两个对象的地址是否相同，如果相同，则返回 YES；否则，它将比较两个对象的属性值、实例变量、方法等是否相同，如果相同，则返回 YES；否则，返回 NO。</p><p>isEqualTo: is part of the Cocoa AppleScript support infrastructure (specifically, NSComparisonMethods, which allow AppleScript to compare Cocoa objects). It&rsquo;s normally the same as isEqual:, but can be overridden if you want equality to work differently internally and in a script.</p><p>isEqualTo: 方法是 Cocoa AppleScript 支持基础设施的一部分（具体来说，它是 NSComparisonMethods 的一部分，它允许 AppleScript 比较 Cocoa 对象）。它通常与 isEqual: 相同，但如果你想在内部和脚本中使用不同的相等性，则可以覆盖它。</p><blockquote><p><a href=https://www.jianshu.com/p/1d05bf21d8f9>isEqual ，isEqualToString ， == 三者的区别</a></p></blockquote><p>isEqual: 首先判断两个对象是否类型一致， 在判断具体内容是否一致，如果类型不同直接return no.如先判断是否都是 NSString，在判断string的内容。</p><p>isEqualToString: 这个直接判断字符串内容。</p><p>==是直接比较指向的地址。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>- (<span style=color:#66d9ef>BOOL</span>)<span style=color:#a6e22e>isEqual:</span>(<span style=color:#66d9ef>id</span>)other {  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (other <span style=color:#f92672>==</span> self) { 
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> YES;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>other <span style=color:#f92672>||</span> <span style=color:#f92672>!</span>[other isKindOfClass:[self <span style=color:#66d9ef>class</span>]]) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> NO;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> [self isEqualToWidget:other]; 
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>BOOL</span>)<span style=color:#a6e22e>isEqualToWidget:</span>(MyWidget <span style=color:#f92672>*</span>)aWidget {    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (self <span style=color:#f92672>==</span> aWidget) <span style=color:#66d9ef>return</span> YES;    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>[(<span style=color:#66d9ef>id</span>)[self name] isEqual:[aWidget name]]) <span style=color:#66d9ef>return</span> NO;    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>[[self data] isEqualToData:[aWidget data]]) <span style=color:#66d9ef>return</span> NO;    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> YES;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>首先都会判断 指针是否相等，相等直接返回YES，</li><li>不相等再判断是否是同类对象或非空，空或非同类对象直接返回NO，</li><li>而后依次判断对象对应的属性是否相等，若均相等，返回YES</li><li>这样就不难理解 isEqualToString 的实现内部的了</li></ul><blockquote><p><a href=https://www.jianshu.com/p/915356e280fc>iOS开发 之 不要告诉我你真的懂isEqual与hash!</a></p></blockquote><p>为什么要有isEqual方法?
isEqual方法的作用大家肯定是知道的:</p><blockquote><p>判断两个对象是否相等</p></blockquote><p>但是判断相等不是已经有==运算符了么, 为什么还要isEqual方法?</p><p>这是因为:</p><blockquote><p>对于基本类型, ==运算符比较的是值; 对于对象类型, ==运算符比较的是对象的地址(即是否为同一对象)</p></blockquote><p>注意: 上述==运算符的说明适用于Objective-C和Java等不支持运算符重载的语言, 支持运算符重载的语言有C++</p><p>所以要理清==运算符和isEqual方法的区别, 问题就集中在</p><p>什么叫比较对象的地址, 什么叫比较对象</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>UIColor <span style=color:#f92672>*</span>color1 <span style=color:#f92672>=</span> [UIColor colorWithRed:<span style=color:#ae81ff>0.5</span> green:<span style=color:#ae81ff>0.5</span> blue:<span style=color:#ae81ff>0.5</span> alpha:<span style=color:#ae81ff>1.0</span>];
</span></span><span style=display:flex><span>UIColor <span style=color:#f92672>*</span>color2 <span style=color:#f92672>=</span> [UIColor colorWithRed:<span style=color:#ae81ff>0.5</span> green:<span style=color:#ae81ff>0.5</span> blue:<span style=color:#ae81ff>0.5</span> alpha:<span style=color:#ae81ff>1.0</span>];
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;color1 == color2 = %@&#34;</span>, color1 <span style=color:#f92672>==</span> color2 <span style=color:#f92672>?</span> <span style=color:#e6db74>@&#34;YES&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>@&#34;NO&#34;</span>);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;[color1 isEqual:color2] = %@&#34;</span>, [color1 isEqual:color2] <span style=color:#f92672>?</span> <span style=color:#e6db74>@&#34;YES&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>@&#34;NO&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// color1 == color2 = NO
</span></span></span><span style=display:flex><span><span style=color:#75715e>// [color1 isEqual:color2] = YES
</span></span></span></code></pre></div><p>从上面的例子可以看出, ==运算符只是简单地判断是否是同一个对象, 而isEqual方法可以判断对象是否相同, 例如UIColor对象表示的color是否相同</p><h3 id=--isequal-objc--swift>==, ===, isEqual: Objc & Swift</h3><blockquote><p><a href=https://swifter.tips/equal/>onevcat: 判等</a></p></blockquote><p>我们在 Objective-C 时代，通常使用 -isEqualToString: 来在已经能确定比较对象和待比较对象都是 NSString 的时候进行字符串判等。Swift 中的 String 类型中是没有 -isEqualToString: 或者 -isEqual: 这样的方法的，因为这些毕竟是 NSObject 的东西。在 Swift 的字符串内容判等，我们简单地使用 == 操作符来进行</p><p>在判等上 Swift 的行为和 Objective-C 有着巨大的差别。在 Objective-C 中 == 这个符号的意思是判断两个对象是否指向同一块内存地址。其实很多时候这并不是我们经常所期望的判等，我们更关心的往往还是对象的内容相同，而这种意义的相等即使两个对象引用的不是同一块内存地址时，也是可以做到的。Objective-C 中我们通常通过对 -isEqual: 进行重写，或者更进一步去实现类似 -isEqualToString: 这样的 -isEqualToClass: 的带有类型信息的方法来进行内容判等。如果我们没有在任意子类重写 -isEqual: 的话，在调用这个方法时会直接使用 NSObject 中的版本，去直接进行 Objective-C 的 == 判断。</p><p>在 Swift 中情况大不一样，Swift 里的 == 是一个操作符的声明，在 Equatable 里声明了这个操作符的接口方法：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>protocol</span> <span style=color:#a6e22e>Equatable</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>func</span> ==(lhs: <span style=color:#66d9ef>Self</span>, rhs: <span style=color:#66d9ef>Self</span>) -&gt; Bool
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>对于原来 Objective-C 中使用 == 进行的对象指针的判定，在 Swift 中提供的是另一个操作符 ===。在 Swift 中 === 只有一种重载：</p><p><code>func ===(lhs: AnyObject?, rhs: AnyObject?) -> Bool</code></p><p>它用来判断两个 AnyObject 是否是同一个引用。</p><p>对于判等，和它紧密相关的一个话题就是哈希，因为哈希是一个稍微复杂的话题，所以我将它分成了一个单节。但是如果在实际项目中你需要重载 == 或者重写 -isEqual: 来进行判等的话，很可能你也会想看看有关哈希的内容，重载了判等的话，我们还需要提供一个可靠的哈希算法使得判等的对象在字典中作为 key 时不会发生奇怪的事情。</p><h2 id=category>Category</h2><ul><li><a href=https://tech.meituan.com/2015/03/03/diveintocategory.html>深入理解Objective-C：Category</a></li><li><a href=https://juejin.cn/post/6844903968691191815>【iOS面试粮食】OC语言—Category(分类)和类扩展(extension)、关联对象</a></li></ul><blockquote><p><a href=https://www.jianshu.com/p/dc3196030a03>OC基础之类别（Category）和扩展（Extension）</a></p></blockquote><p>.h文件中的格式为</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>#import &#34;类名.h&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@interface</span> <span style=color:#960050;background-color:#1e0010>类名 (类别名)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 在此处声明方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>@end</span>
</span></span></code></pre></div><p>.m文件中的格式为</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>#import &#34;类名+类别名.h&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@implementation</span> <span style=color:#960050;background-color:#1e0010>类名 (类别名)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 在此处实现声明的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>@end</span>
</span></span></code></pre></div><p>扩展文件格式 .h文件中的格式为</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>#import &#34;类名.h&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@interface</span> <span style=color:#960050;background-color:#1e0010>类名 () &lt;</span><span style=color:#a6e22e>XYZViewDelegate</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 在此添加私有成员变量、属性、声明方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>@end</span>
</span></span></code></pre></div><p>(): 这里的空括号表示类的扩展（Extension），在扩展中可以添加额外的成员变量、属性、方法或遵循协议等，以增强类的功能。</p><p>这里使用尖括号括起来的部分表示该类遵循了一个协议XYZViewDelegate。协议名称放在尖括号内，多个协议之间可以用逗号分隔。遵循协议意味着该类的实例可以实现协议中定义的方法，以响应相关事件或提供实现。</p><h3 id=details>Details</h3><p>Objective-C的Category和Extension
Category是Objective-C语言的一个特性，它主要用于为现有的类添加新的方法，无论这个类是系统类还是自定义类。你可以将类的实现分散到多个不同的源文件中，这使得你可以在不访问类源代码的情况下扩展类的功能。</p><p>Extension在语法上看起来几乎和Category相同，但它只能为自己的类添加新的方法和属性，而不能为系统类或他人的类添加新的方法或属性。另外，Extension的方法和属性在编译器会检查是否实现，而Category则不会。</p><p>Swift的Extension
Swift中的Extension的功能比Objective-C中的Category和Extension更强大。它不仅可以向现有的类添加新的方法和计算属性，还可以向现有的类添加新的构造函数、下标、嵌套类型，甚至可以使现有类型遵循特定的协议。</p><p>对比
Category和Swift的Extension都可以为现有类添加新的方法，但是Swift的Extension可以为现有类添加更多的新特性，比如新的构造函数、下标、嵌套类型和遵循协议等。</p><p>Category和Extension可以为系统类和他人的类添加新的方法，而Objective-C的Extension只能为自己的类添加新的方法和属性。</p><p>在Objective-C中，你可以在Category中覆盖原有类的方法，而在Swift中，你不能在Extension中覆盖原有类的方法。</p><p>Objective-C的Extension在编译器会检查方法和属性的实现，而Category则不会。在Swift中，你不能在Extension中添加新的存储属性，只能添加新的计算属性。</p><h3 id=实现>实现</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>// NSString+MyCategory.h
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#import &lt;Foundation/Foundation.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@interface</span> <span style=color:#a6e22e>NSString</span> (MyCategory)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>BOOL</span>)<span style=color:#a6e22e>isNotEmpty</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// NSString+MyCategory.m
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#import &#34;NSString+MyCategory.h&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@implementation</span> <span style=color:#a6e22e>NSString</span> (MyCategory)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>BOOL</span>)<span style=color:#a6e22e>isNotEmpty</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#f92672>!</span>[self isEqualToString:<span style=color:#e6db74>@&#34;&#34;</span>];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>// MyClass.m
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#import &lt;Foundation/Foundation.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@interface</span> <span style=color:#a6e22e>MyClass</span> : <span style=color:#a6e22e>NSObject</span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>void</span>)<span style=color:#a6e22e>myMethod</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@implementation</span> <span style=color:#a6e22e>MyClass</span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>void</span>)<span style=color:#a6e22e>myMethod</span> {
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;Hello, world!&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> main() {
</span></span><span style=display:flex><span>    MyClass <span style=color:#f92672>*</span>myObject <span style=color:#f92672>=</span> [[MyClass alloc] init];
</span></span><span style=display:flex><span>    [myObject myMethod];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><blockquote><p><code>@implementation ObjcBaseViewController (Alert)</code> 括号里是什么</p></blockquote><p>在 Objective-C 中，圆括号 () 中的内容表示一个类别（Category）的名称。在你给出的这个例子中，Alert 是 ObjcBaseViewController 类的一个类别。</p><p>类别是 Objective-C 中一种允许你添加新方法（但不能添加新属性或实例变量）到现有类的机制。你可以使用类别来添加方法到系统类，例如 NSString、NSArray、自己的自定义类等等。</p><p>你的代码中 @implementation ObjcBaseViewController (Alert) 是 ObjcBaseViewController 类别 Alert 的实现部分的开始。在这里，你可以实现你希望添加到 ObjcBaseViewController 类中的方法。</p><blockquote><p><code>@implementation NSString (MyCategory)</code> 为什么要加 MyCategory，我看也没有用到</p></blockquote><p>在 Objective-C 中，使用 @implementation NSString (MyCategory) 的形式是为了声明一个名为 &ldquo;MyCategory&rdquo; 的 NSString 类别。在这里，&ldquo;MyCategory&rdquo; 是类别的名称，而不是要在代码中使用的一个变量。你可以将其视为给这个类别的标签或名称，用于区分其他可能存在的类别。</p><p>类别（Category）的主要用途是为现有的类添加新的方法。你可能会想，为什么不直接在类的主要实现部分中添加这些方法呢？原因是类别提供了一种组织代码的方式，允许你将相关的方法分组，尤其是当这些方法是为了某一特定的功能或用途时。</p><p>在你的示例中，&ldquo;MyCategory&rdquo; 可能是用来指示这些新方法的用途的。比如说，如果你添加的方法是用来处理字符串格式化的，你可能会选择命名为 &ldquo;Formatting&rdquo;。这样，当其他开发者看到 @implementation NSString (Formatting) 时，他们可以很快理解这些方法的用途。</p><p>请注意，类别名在代码中并没有实际的功能性用途，它仅仅是一个标识，用于区分不同的类别。尽管如此，选择一个有意义的名字可以使你的代码更易于理解和维护。</p><h2 id=ios-constant---static-nsstring--const-kstr-->iOS Constant - <code>static NSString * const kStr = @""</code></h2><blockquote><p><a href=https://toutiao.io/posts/kw76e7/preview>iOS 不要用宏来定义你的常量</a></p></blockquote><p>iOS 不要用宏来定义你的常量</p><p>最近在工程里看到很多不规范的使用，于是来写一篇博客来让不是很清楚的小朋友们，少埋点坑。</p><p>首先，预处理命令他不是一个常量！！！！</p><p>我们来看一段代码</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>#define avatar @&#34;60&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (false) {
</span></span><span style=display:flex><span><span style=color:#75715e>#define avatar @&#34;80&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>NSLog(avatar);
</span></span></code></pre></div><h3 id=首先预处理命令他不是一个常量>首先，预处理命令他不是一个常量！！！！</h3><p>这段代码会输出多少，我们将“avatar”定义为了60，然后在一个永远不会执行的代码里面重新定义了“avatar”为80，if语句中的代码永远不会执行，但是在编译时期，编译器会编译这段代码，而这个时候编译器就会将avatar这个名字替换为@“80”，所以这段代码最后的输出结果就是80。</p><p>当然这个时候编译器是会有一个警告的，但是不知道有多少同学会忽略这个警告。或者你会告诉我你对警告十分敏感，不会放过他的，但是记住你不是一个人在写代码，可能在别人的页面他给你重新定义了你的define，给你挖了一个大坑，还找不着………</p><h3 id=用const来定义一个常量>用const来定义一个常量</h3><p>const修饰符定义的变量是不可变的，比如说你需要定义一个动画时间的常量，你可以这么做：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>const</span> NSTimeInterval kAnimateDuration <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.3</span>;
</span></span></code></pre></div><p>当你试图去修改“ kAnimateDuration”的值的时候，编译器会报错。更加重要的是用这种方法定义的常量是带有类型信息的，而这点则是define不具备的。</p><p>也许你已经发现了，如果你像这样定义：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>const</span> NSString <span style=color:#f92672>*</span> kUserName <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;StrongX&#34;</span>;
</span></span></code></pre></div><p>你是可以修改userName的值的，（说好的常量呢～～～）</p><p>首先我们需要确定的是以下两种写法是一样的：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>static</span> NSString <span style=color:#66d9ef>const</span> <span style=color:#f92672>*</span> kUserName <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;StrongX&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>const</span> NSString <span style=color:#f92672>*</span> kUserName <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;StrongX&#34;</span>;
</span></span></code></pre></div><p>也就是说const放在类型前还是类型后是一样的效果。然后不同效果的是下面这种写法：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>static</span> NSString <span style=color:#f92672>*</span> <span style=color:#66d9ef>const</span> kUserName <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;StrongX&#34;</span>;
</span></span></code></pre></div><p>const 修饰的是他右边的部分，也就是说：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>static</span> NSString <span style=color:#66d9ef>const</span> <span style=color:#f92672>*</span> kUserName <span style=color:#f92672>=</span> <span style=color:#66d9ef>static</span> NSString <span style=color:#66d9ef>const</span> (<span style=color:#f92672>*</span> kUserName )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> NSString <span style=color:#f92672>*</span> <span style=color:#66d9ef>const</span> kUserName <span style=color:#f92672>=</span> <span style=color:#66d9ef>static</span> NSString <span style=color:#f92672>*</span> <span style=color:#66d9ef>const</span> (kUserName)
</span></span></code></pre></div><p>当const修饰的是(userName)的时候，不可变的是userName;星号在C语言中表示指针指向符，也就是说这个时候userName指向的内存块地址不可变，而内存保存的内容是可变的，我们来做个尝试：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;内存地址： %x&#34;</span>,<span style=color:#f92672>&amp;</span> kUserName);
</span></span><span style=display:flex><span>kUserName <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;superXLX&#34;</span>;
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;内存地址： %x&#34;</span>,<span style=color:#f92672>&amp;</span> kUserName);
</span></span></code></pre></div><p>以上NSLog会打印*userName指向的内存块地址，而他的输出是：</p><p>我们已经发现当我们改变内存的内存的时候他的地址并没有发生改变，也就是说这是符合“const”修饰符的规定的。
而当我们的修饰符是这样的时候：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>static</span> NSString <span style=color:#f92672>*</span> <span style=color:#66d9ef>const</span> kUserName <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;StrongX&#34;</span>;
</span></span></code></pre></div><p>我们则无法改变userName的值。</p><p>所以当我们需要定义一个不可变的常量的时候 ，我们还是需要将“const”修饰符放到“*”指针指向符后边才对。</p><h3 id=一定要同时使用static和const来定义你的变量>一定要同时使用static和const来定义你的变量</h3><p>上面已经说了const是用来定义一个常量。而static在C语言中（OC中延用）则表明此变量只在改变量的输出文件中可用(.m文件)，如果你不加“static”符号，那么编译器就会对该变量创建一个“外部符号”，后果是什么呢？</p><p>你可以尝试在不同编译文件中加入以下代码：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSString <span style=color:#f92672>*</span> <span style=color:#66d9ef>const</span> kUserName <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;StrongX&#34;</span>;
</span></span></code></pre></div><p>可能尽管文件之间并没有相互引用，不存在属性名重复的问题（因为这并不是一个属性，这是一个外部符号）,但是编译器还是报错了:</p><p>他会告诉你在两个目标文件(.0文件是.m文件编译后的输出文件)有一个重复的符号。(OC中没有类似C++中的名字空间的概念)</p><p>所以当你在你自己的.m文件中需要声明一个只有你自己可见的局部变量(k开头)的变量的时候一定要同时使用“static”和“const”两个符号。</p><h3 id=定义工程中的全局变量>定义工程中的全局变量</h3><p>在我们的工程中一定会定义很多全局常量，很多人的做法是会创建一个“ constant.h”文件，在这个文件中用#define声明许多常量，然后将这个头文件引入“pch”文件中，不能说这么做不对，但是如同上面说的那样define可能被修改，当然在命名规范的情况下这种情况很少出现，并且这样做的效率很高。</p><p>然而苹果更推荐另外一种做法:”extern”，这样做的优势是保持常量绝对不会被修改，并且一定初始化还带有类型信息。</p><p>我们在”constants.h”文件中，声明常量：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>extern</span> NSString <span style=color:#f92672>*</span><span style=color:#66d9ef>const</span> XUserName;
</span></span></code></pre></div><p>然后在“constants.m”中定义他：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSString <span style=color:#f92672>*</span><span style=color:#66d9ef>const</span> XUserName <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;StrongX&#34;</span>;
</span></span></code></pre></div><p>用“extern”定义的常量必须也只能初始化一次，不满足必须以及只能一次的条件那么编译器就会提醒你。在定义全局变量的时候需要要注意你的命名，你可以使用规定好的前缀来命名。</p><p>“define”和“extern”各有各的优势，不过我个人还是比较推荐使用“extern”.(因为之前在一个工程中被define坑惨了——！)。</p><blockquote><p><a href=https://stackoverflow.com/questions/12815189/whats-the-different-between-const-nsstring-and-static-nsstring>what&rsquo;s the different between const NSString and static NSString</a></p></blockquote><p>I want to use class variable. the following two approaches work well, but I don&rsquo;t know what&rsquo;s the different between them.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>static</span> NSString <span style=color:#f92672>*</span>str1 <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;str1&#34;</span>;
</span></span><span style=display:flex><span>NSString <span style=color:#f92672>*</span><span style=color:#66d9ef>const</span> str2 <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;str2&#34;</span>;
</span></span></code></pre></div><p>you can change the location to where str1 is pointing to but cannot do the same for str2 as it is a const pointer</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>// this will work :
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>str1 <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;Hello&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// while this won&#39;t:
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>str2 <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;Hello&#34;</span>; 
</span></span></code></pre></div><h2 id=weakify-和-strongify>@weakify 和 @strongify</h2><p>@weakify 是一个宏，用于创建一个指向自身的弱引用。在这种情况下，它用于避免闭包中的循环引用。循环引用会导致内存泄漏，因为对象不能正确释放。@weakify 和 @strongify 通常在 Objective-C 中与 ReactiveCocoa 和 ReactiveObjC 库一起使用。</p><p>在闭包中，当你需要引用 self 时，通常需要考虑到循环引用的问题。使用 @weakify(self)，您可以在闭包内部创建一个弱引用的自身。然后，您需要使用 @strongify(self) 宏将弱引用转换回强引用，以便在闭包内部安全地使用 self。</p><p>以下是一个完整的示例，说明了如何在 Objective-C 中使用 @weakify 和 @strongify：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>#import &lt;ReactiveObjC/ReactiveObjC.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>#import &#34;YourClass.h&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@implementation</span> <span style=color:#a6e22e>YourClass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>instancetype</span>)<span style=color:#a6e22e>init</span> {
</span></span><span style=display:flex><span>    self <span style=color:#f92672>=</span> [super init];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (self) {
</span></span><span style=display:flex><span>        [self setup];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> self;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>void</span>)<span style=color:#a6e22e>setup</span> {
</span></span><span style=display:flex><span>    @weakify(self)
</span></span><span style=display:flex><span>    [[RACObserve(self, someProperty) skip:<span style=color:#ae81ff>1</span>] subscribeNext:<span style=color:#f92672>^</span>(<span style=color:#66d9ef>id</span> x) {
</span></span><span style=display:flex><span>        @strongify(self)
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 在这里安全地使用 self，而不会导致循环引用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        [self doSomething];
</span></span><span style=display:flex><span>    }];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>void</span>)<span style=color:#a6e22e>doSomething</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@end</span>
</span></span></code></pre></div><p>在此示例中，我们使用 RACObserve 监听名为 someProperty 的属性的变化。当属性发生变化时，我们的闭包会被调用。在闭包中，我们使用 @strongify(self) 将弱引用转换回强引用，以便安全地使用 self。这种方法避免了循环引用问题。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>[model setDidSelectRow:<span style=color:#f92672>^</span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// @strongify(self)：这是一个宏，用于避免在 block 内部出现循环引用的问题。它会创建一个强引用的 self 变量，以确保在 block 内部可以安全地访问 self 对象。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    @strongify(self)
</span></span><span style=display:flex><span>    UIViewController <span style=color:#f92672>*</span>vc <span style=color:#f92672>=</span> [UIViewController new];
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 通过导航控制器将 vc 推入到当前视图控制器的导航堆栈中，实现页面的切换和导航。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    [self.navigationController pushViewController:vc animated:YES];
</span></span><span style=display:flex><span>}];
</span></span></code></pre></div><h2 id=type-size>Type Size</h2><blockquote><p>Values of type &lsquo;NSUInteger&rsquo; should not be used as format arguments; add an explicit cast to &lsquo;unsigned long&rsquo; instead</p><p>Replace &lsquo;%d", &rsquo; with &lsquo;%lu", (unsigned long)&rsquo;</p></blockquote><p>NSUInteger 是 Objective-C 中的一个无符号整数类型，用于表示对象的数量或容器中的元素数量。在使用 NSUInteger 作为格式化字符串的参数时，您需要使用 %lu 格式化符号来指定它的类型。这是因为在 64 位架构下，NSUInteger 的大小为 8 个字节，而 %d 只能处理 4 个字节的有符号整数。</p><p>以下是一个示例，展示了如何使用 %lu 格式化符号来输出 NSUInteger 值：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSUInteger count <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;The count is: %lu&#34;</span>, count);
</span></span></code></pre></div><p>在上面的示例中，我们首先创建了一个名为 count 的 NSUInteger 变量，其值为 10。然后，我们使用 NSLog 函数输出一个带有格式化字符串的消息，并使用 %lu 格式化符号将 count 变量的值输出为一个无符号长整型。这将确保在 64 位架构下正确处理 NSUInteger 类型的值。</p><p>请注意，在 32 位架构下，NSUInteger 的大小为 4 个字节，因此您可以使用 %u 格式化符号来指定它的类型。</p><h2 id=ternary-operator>Ternary Operator</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSString <span style=color:#f92672>*</span>content <span style=color:#f92672>=</span> searchContent <span style=color:#f92672>?:</span> kDefaultSearchText;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// equation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>NSString <span style=color:#f92672>*</span>content;
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (searchContent) {
</span></span><span style=display:flex><span>    content <span style=color:#f92672>=</span> searchContent;
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    content <span style=color:#f92672>=</span> kDefaultSearchText;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This is also called the null coalescing operator, and it is used to simplify conditional assignment. If searchContent is not nil, then it is assigned to content, otherwise kDefaultSearchText is assigned to content.</p><p>这个语法也被称为 null coalescing operator，用于简化条件赋值操作，如果 searchContent 不为空，则将其赋值给 content，否则将 kDefaultSearchText 赋值给 content。</p><h2 id=block>block</h2><blockquote><p><a href=https://book.douban.com/subject/26613294/>Objective-C编程（第2版）</a></p><p>本书将 iOS 4.0 加入的语言特性 Blocks 翻译为 “Block 对象”，因为 Blocks 是简称，其正式名称为 Block Object。</p><p>Block 对象是一段代码</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#f92672>^</span>{
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;This is an instruction within a block.&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>^</span>(<span style=color:#66d9ef>double</span> divident, <span style=color:#66d9ef>double</span> divisor) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>double</span> quotient <span style=color:#f92672>=</span> dividend <span style=color:#f92672>/</span> divisor;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> quotient;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Block 变量声明
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>void</span> (<span style=color:#f92672>^</span>devowelizer)(<span style=color:#66d9ef>id</span>, NSUInter, Bool<span style=color:#f92672>*</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span><span style=color:#f92672>:</span> block <span style=color:#960050;background-color:#1e0010>对象的返回类型</span>
</span></span><span style=display:flex><span>block: <span style=color:#960050;background-color:#1e0010>变量的名称</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>实参类型</span>
</span></span></code></pre></div><p><code>^(id _Nonnull sender){}</code> 是一个 Objective-C 语言中的语法，用于定义一个块对象（Block Object）。块对象是一种将代码块封装为对象的技术，在 Objective-C 中广泛应用于异步编程和事件处理等方面。</p><p>在这个语法中，<code>^</code> 符号表示定义了一个块对象，后面的 <code>(id _Nonnull sender)</code> 则表示块对象的参数列表，这里只有一个类型为 id，并且不能为 nil 的参数 sender。括号中的 <code>_Nonnull</code> 表示该参数不能为 nil，这是 Objective-C 的一个空类型限定符（nullability qualifier）。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>[self addGestureRecognizer:[[UITapGestureRecognizer alloc] initWithActionBlock:<span style=color:#f92672>^</span>(<span style=color:#66d9ef>id</span>  _Nonnull sender) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (actionBlock) {
</span></span><span style=display:flex><span>        actionBlock();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}]];
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#75715e>// swift like</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>self</span>.addGestureRecognizer(UITapGestureRecognizer { <span style=color:#66d9ef>_</span> <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>    actionBlock?()
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><h3 id=read-more>Read More</h3><blockquote><p><a href=http://www.bczl.xyz/objc/doc-zh/8.Working-with-Blocks.html>使用Blocks</a></p></blockquote><h2 id=_nullable>_Nullable</h2><blockquote><p><a href=https://kangzubin.com/nullability-and-objective-c/>Objective-C 中 nullable、__nullable、_Nullable 的区别</a></p></blockquote><h2 id=ns_assume_nonnull_begin-和-ns_assume_nonnull_end><code>NS_ASSUME_NONNULL_BEGIN</code> 和 <code>NS_ASSUME_NONNULL_END</code></h2><blockquote><p><a href=https://www.jianshu.com/p/67aa3bbb68c6>NS_ASSUME_NONNULL_BEGIN和NS_ASSUME_NONNULL_END</a></p><p>在swift中，可以使用!和?来表示一个对象是optional的还是non-optional，如view?和view!。而在Objective-C中则没有这一区分，view即可表示这个对象是optional，也可表示是non-optioanl。这样就会造成一个问题：在Swift与Objective-C混编时，Swift编译器并不知道一个Objective-C对象到底是optional还是non-optional，因此这种情况下编译器会隐式地将Objective-C的对象当成是non-optional。</p><p>为了解决这个问题，苹果在Xcode 6.3引入了一个Objective-C的新特性：nullability annotations。这一新特性的核心是两个新的类型注释：__nullable和__nonnull。从字面上我们可以猜到，__nullable表示对象可以是NULL或nil，而__nonnull表示对象不应该为空。当我们不遵循这一规则时，编译器就会给出警告。</p><p>如果需要每个属性或每个方法都去指定nonnull和nullable，是一件非常繁琐的事。苹果为了减轻我们的工作量，专门提供了两个宏：</p><p>NS_ASSUME_NONNULL_BEGIN和NS_ASSUME_NONNULL_END。这两个宏的定义是：</p><p><code>#define NS_ASSUME_NONNULL_BEGIN _Pragma("clang assume_nonnull begin")</code></p><p><code>#define NS_ASSUME_NONNULL_END _Pragma("clang assume_nonnull end")</code></p><p>在这两个宏之间的代码，所有简单指针对象都被假定为nonnull，因此我们只需要去指定那些nullable的指针。</p></blockquote><p><code>NS_ASSUME_NONNULL_END</code> 是在 Objective-C 代码中使用的一个预处理指令，用于帮助处理空值（null）的情况。</p><p>在 Objective-C 中，默认情况下，所有的对象类型都可以是空值（null），即可以为 nil。这意味着你需要经常使用空值检查，以确保对象不是空值，然后再进行操作，以避免出现潜在的崩溃或错误。</p><p>而 <code>NS_ASSUME_NONNULL_END</code> 的作用是假设在该指令之后声明的所有对象类型都不会是空值。换句话说，这个指令为代码中的对象类型添加了一个非空的假设，从而减少了空值检查的需要。在这种情况下，你可以假设对象都是非空的，并直接进行操作，而无需每次都进行空值检查。</p><p>使用 <code>NS_ASSUME_NONNULL_END</code> 可以简化代码，并提高可读性和可维护性，特别是当你确定某些对象不会为空时。</p><p>需要注意的是，你仍然需要对来自外部或不确定的源的对象进行空值检查，以确保代码的健壮性。</p><p>以下是使用 <code>NS_ASSUME_NONNULL_END</code> 的示例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NS_ASSUME_NONNULL_BEGIN
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 在这里声明的对象类型默认为非空
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>strong</span>) NSString <span style=color:#f92672>*</span>nonNullableString;
</span></span><span style=display:flex><span><span style=color:#66d9ef>@property</span> (<span style=color:#66d9ef>nonatomic</span>, <span style=color:#66d9ef>strong</span>, nullable) NSString <span style=color:#f92672>*</span>nullableString;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NS_ASSUME_NONNULL_END
</span></span></code></pre></div><p>在上述示例中，<code>nonNullable String</code> 被假设为非空，所以你可以直接使用它而无需进行空值检查。而 nullable String 则是一个可空的对象，你仍然需要进行空值检查。</p><p>总而言之，<code>NS_ASSUME_NONNULL_END</code> 提供了一种简化空值检查的方式，但你仍然需要在适当的情况下进行空值检查，以确保代码的正确性和健壮性。</p><h2 id=id-type>id type</h2><p><a href=https://www.jianshu.com/p/80ef5030e6c0>OC中的id类型</a></p><h3 id=1-静态类型和动态类型>1. 静态类型和动态类型</h3><p>静态类型</p><p>将一个指针变量定义为特定类的对象时,使用的是静态类型,在编译的时候就知道这个指针变量所属的类,这个变量总是存储特定类的对象。</p><p><code>Person *p = [Person new];</code></p><p>动态类型</p><p>这一特性是程序直到执行时才确定对象所属的类</p><p><code>id obj = [Person new];</code></p><h3 id=2-为什么要有动态类型>2. 为什么要有动态类型?</h3><ul><li>我们知道 NSObject 是 OC 中的基类</li><li>那么任何对象的 NSObject 类型的指针可以指向任意对象，都没有问题</li><li>但是 NSObject 是静态类型，如果通过它直接调用 NSObject 上面不存在的方法，编译器会报错。</li><li>你如果想通过 NSObject 的指针调用特定对象的方法，就必须把 <code>NSObject *</code> 这种类型强转成特定类型。然后调用。如下</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>//定义 NSObject * 类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>NSObject<span style=color:#f92672>*</span> obj <span style=color:#f92672>=</span> [Cat new];
</span></span><span style=display:flex><span>Cat <span style=color:#f92672>*</span>c <span style=color:#f92672>=</span> (Cat<span style=color:#f92672>*</span>)obj;
</span></span><span style=display:flex><span>[c eat];
</span></span></code></pre></div><p>id 是一种通用的对象类型,它可以指向属于任何类的对象,也可以理解为万能指针 ,相当于C语言的 <code>void *</code></p><p>因为 id 是动态类型,所以可以通过 id 类型直接调用指向对象中的方法, 编译器不会报错</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>/// Represents an instance of a class.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>struct</span> objc_object {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Class</span> isa  OBJC_ISA_AVAILABILITY;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// A pointer to an instance of a class.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>struct</span> objc_object <span style=color:#f92672>*</span><span style=color:#66d9ef>id</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>id</span> obj <span style=color:#f92672>=</span> [C at new];
</span></span><span style=display:flex><span>[obj eat]; <span style=color:#75715e>// 不用强制类型转换
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>[obj test]; <span style=color:#75715e>//可以调用私有方法
</span></span></span></code></pre></div><p>注意：</p><ul><li>在id的定义中,已经包好了*号。id指针只能指向OC中的对象<ul><li>为了尽可能的减少编程中出错，Xcode做了一个检查，当使用id 类型的调用本项目中所有类中都没有的方法，编译器会报错</li><li>id 类型不能使用.语法, 因为.语法是编译时特性, 而id是运行时特性</li></ul></li></ul><h3 id=3-id数据类型与静态类型>3. id数据类型与静态类型</h3><p>虽然说id数据类型可以存储任何类型的对象，但是不要养成滥用这种通用类型</p><ul><li>如没有使用到多态尽量使用静态类型</li><li>静态类型可以更早的发现错误(在编译阶段而不是运行阶段)</li><li>静态类型能够提高程序的可读性</li><li>使用动态类型前最好判断其真实类型</li></ul><p>动态类型判断类型</p><p><code>- (BOOL)isKindOfClass:classObj</code> 判断实例对象是否是这个类或者这个类的子类的实例</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>Person <span style=color:#f92672>*</span>p <span style=color:#f92672>=</span> [Person new];
</span></span><span style=display:flex><span>Student <span style=color:#f92672>*</span>stu <span style=color:#f92672>=</span> [Student new];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>BOOL</span> res <span style=color:#f92672>=</span> [p isKindOfClass:[Person <span style=color:#66d9ef>class</span>]];
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;res = %i&#34;</span>, res); <span style=color:#75715e>// YES
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>res <span style=color:#f92672>=</span> [stu isKindOfClass:[Person <span style=color:#66d9ef>class</span>]];
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;res = %i&#34;</span>, res); <span style=color:#75715e>// YES
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>- (<span style=color:#66d9ef>BOOL</span>) <span style=color:#a6e22e>isMemberOfClass:</span> classObj <span style=color:#960050;background-color:#1e0010>判断是否是这个类的实例</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Person <span style=color:#f92672>*</span>p <span style=color:#f92672>=</span> [Person new];
</span></span><span style=display:flex><span>Student <span style=color:#f92672>*</span>stu <span style=color:#f92672>=</span> [Student new];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>BOOL</span> res <span style=color:#f92672>=</span> [p isMemberOfClass:[Person <span style=color:#66d9ef>class</span>]];
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;res = %i&#34;</span>, res); <span style=color:#75715e>// YES
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>res <span style=color:#f92672>=</span> [stu isMemberOfClass:[Person <span style=color:#66d9ef>class</span>]];
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;res = %i&#34;</span>, res); <span style=color:#75715e>// NO
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>+ (<span style=color:#66d9ef>BOOL</span>) <span style=color:#a6e22e>isSubclassOfClass:</span>classObj <span style=color:#960050;background-color:#1e0010>判断类是否是指定类的子类</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>BOOL</span> res <span style=color:#f92672>=</span> [Person isSubclassOfClass:[Student <span style=color:#66d9ef>class</span>]];
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;res = %i&#34;</span>, res); <span style=color:#75715e>// NO
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>res <span style=color:#f92672>=</span> [Student isSubclassOfClass:[Person <span style=color:#66d9ef>class</span>]];
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;res = %i&#34;</span>, res); <span style=color:#75715e>// YES
</span></span></span></code></pre></div><h2 id=k-keyword>k Keyword</h2><p>在 Objective-C 中，以 k 开头的命名惯例表示常量。这是一种约定俗成的命名方式，用于标识在代码中具有固定值的常量变量。</p><p>例如，你可能会看到像 kMaxItemCount、kDefaultAnimationDuration 这样的命名。这些变量通常用于表示固定不变的值，如最大数量、默认动画持续时间等。</p><p>使用 k 开头的命名方式有助于在代码中更容易地识别和区分常量变量，使其与其他变量和方法名区分开来。此外，它还提醒开发者不要修改这些常量的值，以确保其始终保持不变。</p><p>需要注意的是，k 开头只是一种约定，并没有特殊的语法或功能。因此，你可以根据自己的喜好和团队的约定来决定是否使用 k 开头的命名方式。</p><h2 id=yes-no-true-false>YES, NO, true, false</h2><p>在 Objective-C 中，BOOL 类型表示布尔值（true 或 false）。它是一个基本的 C 数据类型，可以存储 true 或 false 的值。在 Objective-C 中，BOOL 类型的值可以用两个预定义的宏来表示：YES 和 NO。</p><ul><li>YES 表示 true，用于表示一个条件为真的情况。</li><li>NO 表示 false，用于表示一个条件为假的情况。</li></ul><p>这些宏在 Objective-C 中通常用于条件语句和布尔变量的赋值。</p><p>例如，下面是一个示例，演示如何使用 BOOL 类型和 YES、NO 宏：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>BOOL</span> isReady <span style=color:#f92672>=</span> YES;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (isReady <span style=color:#f92672>==</span> YES) {
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;Ready&#34;</span>);
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;Not ready&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 或者直接使用布尔值进行条件判断
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (isReady) {
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;Ready&#34;</span>);
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;Not ready&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>在 Objective-C 中，BOOL 类型的变量可以直接使用 YES 或 NO 进行赋值和比较，也可以使用 true 和 false 的整数值 1 和 0 进行赋值和比较。但通常建议使用 YES 和 NO 宏，以提高代码的可读性和一致性。</p><blockquote><p><a href=https://www.imooc.com/wenda/detail/590463>Objective-C中的YES / NO，TRUE / FALSE和true / false</a></p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>// 我对此进行了详尽的测试。我的结果应该说明一切：
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>//These will all print &#34;1&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, true <span style=color:#f92672>==</span> true);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, TRUE <span style=color:#f92672>==</span> true);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, YES  <span style=color:#f92672>==</span> true);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, true <span style=color:#f92672>==</span> TRUE);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, TRUE <span style=color:#f92672>==</span> TRUE);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, YES  <span style=color:#f92672>==</span> TRUE);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, true <span style=color:#f92672>==</span> YES);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, TRUE <span style=color:#f92672>==</span> YES);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, YES  <span style=color:#f92672>==</span> YES);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, false <span style=color:#f92672>==</span> false);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, FALSE <span style=color:#f92672>==</span> false);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, NO    <span style=color:#f92672>==</span> false);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, false <span style=color:#f92672>==</span> FALSE);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, FALSE <span style=color:#f92672>==</span> FALSE);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, NO    <span style=color:#f92672>==</span> FALSE);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, false <span style=color:#f92672>==</span> NO);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, FALSE <span style=color:#f92672>==</span> NO);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, NO    <span style=color:#f92672>==</span> NO);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//These will all print &#34;0&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, false <span style=color:#f92672>==</span> true);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, FALSE <span style=color:#f92672>==</span> true);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, NO    <span style=color:#f92672>==</span> true);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, false <span style=color:#f92672>==</span> TRUE);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, FALSE <span style=color:#f92672>==</span> TRUE);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, NO    <span style=color:#f92672>==</span> TRUE);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, false <span style=color:#f92672>==</span> YES);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, FALSE <span style=color:#f92672>==</span> YES);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, NO    <span style=color:#f92672>==</span> YES);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, true <span style=color:#f92672>==</span> false);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, TRUE <span style=color:#f92672>==</span> false);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, YES  <span style=color:#f92672>==</span> false);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, true <span style=color:#f92672>==</span> FALSE);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, TRUE <span style=color:#f92672>==</span> FALSE);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, YES  <span style=color:#f92672>==</span> FALSE);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, true <span style=color:#f92672>==</span> NO);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, TRUE <span style=color:#f92672>==</span> NO);
</span></span><span style=display:flex><span>NSLog(<span style=color:#e6db74>@&#34;%d&#34;</span>, YES  <span style=color:#f92672>==</span> NO);
</span></span></code></pre></div><h2 id=typedef>typedef</h2><h3 id=ns_enum>NS_ENUM</h3><p>typedef NS_ENUM(NSInteger, AppStatus) {
AppOpened = 0,
AppNotOpened = 1,
};</p><h3 id=ns_options>NS_OPTIONS</h3><p>typedef NS_OPTIONS(NSUInteger, JYAlertControllerOptions) 和 typedef NS_ENUM(NSUInteger, AlertControllerOptions) 都是用于定义枚举类型的语法，但它们在处理枚举选项的方式上有一些区别。</p><p>typedef NS_OPTIONS(NSUInteger, JYAlertControllerOptions)</p><p>这种语法定义的枚举类型使用了NS_OPTIONS宏，表示这是一个位掩码枚举，即可以使用按位或运算符|组合多个选项值。它们的值应该是2的幂次方，可以独立或组合使用。</p><p>例如，可以这样定义一个使用位掩码的枚举类型：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>typedef</span> <span style=color:#a6e22e>NS_OPTIONS</span>(NSUInteger, AlertControllerOptions) {
</span></span><span style=display:flex><span>    AlertControllerOptionNone      <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    AlertControllerOptionOption1   <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    AlertControllerOptionOption2   <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>    AlertControllerOptionOption3   <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>使用时可以按位或运算符组合选项值：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>JYAlertControllerOptions options <span style=color:#f92672>=</span> AlertControllerOptionOption1 <span style=color:#f92672>|</span> AlertControllerOptionOption3;
</span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> NS_ENUM(NSUInteger, JYAlertControllerOptions)
</span></span></code></pre></div><p>这种语法定义的枚举类型是普通的枚举，表示每个选项是互斥的，不能进行位运算组合。</p><p>例如，可以这样定义一个普通的枚举类型：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>typedef</span> <span style=color:#a6e22e>NS_ENUM</span>(NSUInteger, AlertControllerOptions) {
</span></span><span style=display:flex><span>    AlertControllerOptionNone,
</span></span><span style=display:flex><span>    AlertControllerOptionOption1,
</span></span><span style=display:flex><span>    AlertControllerOptionOption2,
</span></span><span style=display:flex><span>    AlertControllerOptionOption3,
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>使用时可以直接赋值一个选项：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>AlertControllerOptions option <span style=color:#f92672>=</span> AlertControllerOptionOption1;
</span></span></code></pre></div><p>总的来说，使用 NS_OPTIONS 宏定义的枚举类型适用于需要进行位运算组合的场景，而 NS_ENUM 定义的枚举类型适用于互斥的选项。选择使用哪种方式取决于具体的需求和语义。</p><h3 id=typedef-enum>typedef enum</h3><p><code>typedef enum UNAuthorizationOptions : NSUInteger</code> 这种语法是用于定义UNAuthorizationOptions枚举类型，其底层的值类型为NSUInteger。</p><p>在这种语法中，enum关键字用于定义一个枚举类型，而typedef关键字用于为该枚举类型创建一个别名。UNAuthorizationOptions是一个具体的枚举类型名称，NSUInteger指定了该枚举的底层值的数据类型。</p><p>这种方式定义的枚举类型中的选项是互斥的，不能进行位运算组合。每个选项都对应一个唯一的整数值。</p><p>例如，可以这样定义一个使用UNAuthorizationOptions枚举的类型：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>enum</span> UNAuthorizationOptions : NSUInteger {
</span></span><span style=display:flex><span>    UNAuthorizationOptionNone    <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    UNAuthorizationOptionBadge   <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    UNAuthorizationOptionSound   <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>    UNAuthorizationOptionAlert   <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>} UNAuthorizationOptions;
</span></span></code></pre></div><p>使用时可以直接赋值一个选项：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>UNAuthorizationOptions options <span style=color:#f92672>=</span> UNAuthorizationOptionBadge;
</span></span></code></pre></div><p>这种语法与普通的枚举语法（不使用typedef）功能上没有本质区别，只是为了创建一个简洁的别名，方便在代码中使用。</p><h3 id=difference-between-enum-and-ns_enum>difference between enum and NS_ENUM</h3><p>在 Objective-C 中，typedef enum 和 typedef NS_ENUM 都是定义枚举的方式，但 typedef NS_ENUM 提供了更好的类型安全性和易用性。</p><p>typedef enum 是C语言风格的枚举定义方式。例如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>enum</span> {
</span></span><span style=display:flex><span>    Monday,
</span></span><span style=display:flex><span>    Tuesday,
</span></span><span style=display:flex><span>    Wednesday,
</span></span><span style=display:flex><span>    Thursday,
</span></span><span style=display:flex><span>    Friday,
</span></span><span style=display:flex><span>    Saturday,
</span></span><span style=display:flex><span>    Sunday
</span></span><span style=display:flex><span>} DaysOfWeek;
</span></span></code></pre></div><p>然后，你可以像这样使用它：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>DaysOfWeek today <span style=color:#f92672>=</span> Monday;
</span></span></code></pre></div><p>typedef NS_ENUM 是Objective-C的枚举定义方式，它提供了更好的类型安全性和易用性。它有两个参数，第一个参数是要定义的新类型名，第二个参数是基础类型，通常是NSInteger。例如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>typedef</span> <span style=color:#a6e22e>NS_ENUM</span>(NSInteger, AppStatus) {
</span></span><span style=display:flex><span>    AppStatusInactive,
</span></span><span style=display:flex><span>    AppStatusActive,
</span></span><span style=display:flex><span>    AppStatusBackground
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>然后，你可以像这样使用它：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>AppStatus status <span style=color:#f92672>=</span> AppStatusInactive;
</span></span></code></pre></div><p>优点：</p><p>使用NS_ENUM定义的枚举类型，在编译器层面会有更强的类型检查，避免类型混淆的问题。</p><p>NS_ENUM会自动支持 Swift 的语法糖，例如你可以在 Swift 中直接使用 .Inactive 而不是 AppStatusInactive。</p><h2 id=nsdictionary-to-class>NSDictionary to Class</h2><blockquote><p><a href=https://paaatrick.com/2019-02-03-mj-extension-guide/>iOS MJExtension使用方法指南(Objective-C)</a></p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>(</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>messagePushMethod</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>PUSH;</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>userCapsuleMessageSettings</span> <span style=color:#960050;background-color:#1e0010>=</span>         <span style=color:#960050;background-color:#1e0010>(</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>            <span style=color:#960050;background-color:#1e0010>capsuleGroup</span> <span style=color:#960050;background-color:#1e0010>=</span>                 <span style=color:#960050;background-color:#1e0010>(</span>
</span></span><span style=display:flex><span>                                    <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleKey</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>Service5;</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleKeyName</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#f92672>&#34;服务5&#34;</span><span style=color:#960050;background-color:#1e0010>;</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleType</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>service;</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleTypeStatus</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>open;</span>
</span></span><span style=display:flex><span>                }<span style=color:#960050;background-color:#1e0010>,</span>
</span></span><span style=display:flex><span>                                    {
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleKey</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>Service4;</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleKeyName</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#f92672>&#34;服务4&#34;</span><span style=color:#960050;background-color:#1e0010>;</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleType</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>service;</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleTypeStatus</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>open;</span>
</span></span><span style=display:flex><span>                }<span style=color:#960050;background-color:#1e0010>,</span>
</span></span><span style=display:flex><span>                                    {
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleKey</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>Service3;</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleKeyName</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#f92672>&#34;服务3&#34;</span><span style=color:#960050;background-color:#1e0010>;</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleType</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>service;</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleTypeStatus</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>open;</span>
</span></span><span style=display:flex><span>                }<span style=color:#960050;background-color:#1e0010>,</span>
</span></span><span style=display:flex><span>                                    {
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleKey</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>Service2;</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleKeyName</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#f92672>&#34;服务2&#34;</span><span style=color:#960050;background-color:#1e0010>;</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleType</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>service;</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleTypeStatus</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>open;</span>
</span></span><span style=display:flex><span>                }<span style=color:#960050;background-color:#1e0010>,</span>
</span></span><span style=display:flex><span>                                    {
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleKey</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>Service1;</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleKeyName</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#f92672>&#34;服务1&#34;</span><span style=color:#960050;background-color:#1e0010>;</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleType</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>service;</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>capsuleTypeStatus</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#960050;background-color:#1e0010>open;</span>
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            <span style=color:#960050;background-color:#1e0010>);</span>
</span></span><span style=display:flex><span>            <span style=color:#960050;background-color:#1e0010>groupName</span> <span style=color:#960050;background-color:#1e0010>=</span> <span style=color:#e6db74>&#34;活动&#34;</span><span style=color:#960050;background-color:#1e0010>;</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>);</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>)</span> 
</span></span></code></pre></div><h2 id=singleton>singleton</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#75715e>/// 单例
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>+ (<span style=color:#66d9ef>instancetype</span>)<span style=color:#a6e22e>sharedInstance</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> JYUserNotificationManager <span style=color:#f92672>*</span>sharedObject <span style=color:#f92672>=</span> nil;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> dispatch_once_t onceToken;
</span></span><span style=display:flex><span>    dispatch_once(<span style=color:#f92672>&amp;</span>onceToken, <span style=color:#f92672>^</span>{
</span></span><span style=display:flex><span>        sharedObject <span style=color:#f92672>=</span> [JYUserNotificationManager new];
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sharedObject;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=nsuserdefaults>NSUserDefaults</h2><p><a href="https://developer.apple.com/documentation/foundation/nsuserdefaults?language=objc">NSUserDefaults</a></p><p><a href="https://twitter.com/Blankwonder/status/1686246482012450816?s=20">Yachen Liu - Twitter</a></p><blockquote><p>首先解释下背景，UserDefaults 是 iOS/macOS 系统中一个类似于 Windows 注册表的机制。但与注册表不同的是，UserDefaults 并不像注册表那样是整个系统的公用大数据库，它的每个 app 的存储空间是隔离的，这也是导致大部分开发者不理解这项政策的缘由，既然是 per app 隔离的存储，那就和存取一个文件没有区别，为什么要再额外申报，这有什么意义。</p><p>然而事实上 UserDefaults 的行为并非如此，UserDefaults 是一个非常古老的存在，最早在 2001 年的 Mac OS X 中加入，那时候的系统设计还没有太多的隐私考虑。一个关键问题是，UserDefaults 中存在 domain 的分层设计，允许系统通过 UserDefaults 将一些必要的系统设置暴露给 app，这些公共的信息非常庞杂（见附图，如果是开发者的话，可以自己打印 NSUserDefaults.standardUserDefaults.dictionaryRepresentation 查看），比方说 ApplePerAppLanguageSelectionBundleIdentifiers 键值内，就包含了所有曾经手动设置过语言选项的 app 的 bundle id，CarCapabilities 中甚至包含了 CarPlay 设备的唯一序列号，其余键值中包含的时间戳也非常具有特异性。对这些公共设置进行指纹化处理，可以轻松做到跨应用的用户追踪。（这种做法也是很有想象力）</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>for</span> (NSString <span style=color:#f92672>*</span>key <span style=color:#66d9ef>in</span> [[NSUserDefaults standardUserDefaults] dictionaryRepresentation]) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>id</span> value <span style=color:#f92672>=</span> [[[NSUserDefaults standardUserDefaults] dictionaryRepresentation] objectForKey:key];
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;Key: %@, Value: %@&#34;</span>, key, value);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=kvo>KVO</h2><h3 id=kvc>KVC</h3><p><a href=https://github.com/pro648/tips/blob/master/sources/KVC%E5%92%8CKVO%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.md>KVC和KVO学习笔记</a></p><p>在编程中，最常见的就是程序的流程取决于你所使用的各种变量和属性的值，根据变量和属性的值确定后面运行的代码，有时会检查对象是否已加入数组，或是否已被移除，因此，获取类中属性的变化是编程中重要部分。</p><p>我们有多种方式获取对象的改变，如委托、通知等。如果需要观察多个属性的变化，为避免产生大量的代码，最好是使用键值观察（Key Value Observing，简称KVO），这也是Apple在自己的软件中大量使用的一种。</p><p>使用键值观察跟踪单个属性或集合（如数组）的变化非常高效，它只需要在观察者方法中添加代码，不需要修改被观察文件内的代码，这一点和委托、通知不同。但需要注意的是，键值观察（KVO）是建立在键值编码（Key Value Coding，简称KVC）的基础上，也就是说任何你想使用KVO观察的属性必须符合键值编码。</p><h3 id=isa>isa</h3><blockquote><p><a href=https://juejin.cn/post/6844904134286524429>iOS isa详解</a></p><p>有如下代码，在控制台输出obj的数据结构，排在第一位的就是isa的地址。</p></blockquote><p><img src=https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/21/1719d1e1b0d5b132~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image alt=isa-address></p><blockquote><p>为什么呢？因为对象继承自NSObject，NSObject在底层的实现是结构体objc_object，里面只有一个isa成员变量，那么对象的首地址指向的第一块就是isa所在。</p></blockquote><p><img src=https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/4/22/1719d7bec80b8e5e~tplv-t2oaga2asx-zoom-in-crop-mark:4536:0:0:0.image alt=isa-sourcecode></p><h3 id=isa-swizzling>isa-swizzling</h3><p>iOS中的Method Swizzling是一种技术，用于在运行时交换两个方法的实现。它允许开发者在不修改原始代码的情况下，动态改变方法的行为。</p><blockquote><p><a href=https://juejin.cn/post/6844903972528979976>Juejin</a></p><p>Key-Value Observing Implementation Details</p><p>Automatic key-value observing is implemented using a technique called isa-swizzling.</p><p>The isa pointer, as the name suggests, points to the object&rsquo;s class which maintains a dispatch table. This dispatch table essentially contains pointers to the methods the class implements, among other data.</p></blockquote><ul><li><a href=https://www.fatbobman.com/posts/mastering-Observation/>深度解读 Observation —— SwiftUI 性能提升的新途径</a></li><li><a href=https://augmentedcode.io/2020/11/08/observing-a-kvo-compatible-model-in-swiftui-and-mvvm/>Observing a KVO compatible model in SwiftUI and MVVM</a></li></ul><blockquote><p><a href=https://www.jianshu.com/p/ce5bd1383a05>Juejin</a></p></blockquote><p>这里简单来说，就是KVO的实现使用了一种叫做isa-swizzling的技术，主要的原理是当观察一个对象的属性时，这个对象的isa指针将会被修改，isa指针会指向一个中间类，这个中间类是被观察对象的子类，它重写了被观察属性的setter方法。同时为了隐藏中间类，修改了这个中间类的class方法，使它返回的是被观察对象的类而不是这个中间类。</p><h3 id=method-swizzling>method-swizzling</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>UIKit</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>Foundation</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>extension</span> <span style=color:#a6e22e>UIColor</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>@objc</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>colorDescription</span>() -&gt; String {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;Print rainbow colours.&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>let</span> swizzleDescriptionImplementation: Void = {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> instance: UIColor = .red
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> aClass: AnyClass! = object_getClass(instance)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> originalMethod = class_getInstanceMethod(aClass, <span style=color:#66d9ef>#selector</span>(description))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> swizzledMethod = class_getInstanceMethod(aClass, <span style=color:#66d9ef>#selector</span>(colorDescription))
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> originalMethod = originalMethod, <span style=color:#66d9ef>let</span> swizzledMethod = swizzledMethod {
</span></span><span style=display:flex><span>            method_exchangeImplementations(originalMethod, swizzledMethod)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>swizzleDescription</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>self</span>.swizzleDescriptionImplementation
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(UIColor.red)
</span></span><span style=display:flex><span>print(UIColor.blue)
</span></span><span style=display:flex><span>UIColor.swizzleDescription()
</span></span><span style=display:flex><span>print(UIColor.red)
</span></span><span style=display:flex><span>print(UIColor.blue)
</span></span><span style=display:flex><span>UIColor.swizzleDescription()
</span></span><span style=display:flex><span>print(UIColor.red)
</span></span><span style=display:flex><span>print(UIColor.blue)
</span></span></code></pre></div><h2 id=消息转发---message-forwarding>消息转发 - Message Forwarding</h2><blockquote><p><a href=https://juejin.cn/post/6844903600968171533>消息转发篇(Message Forwarding)</a></p></blockquote><ul><li>方法：与一个类相关的一段实际代码，并给出一个特定的名字。例：<code>- (int)meaning { return 42; }</code></li><li>消息：发送给对象的名称和一组参数。示例：向0x12345678对象发送 <code>meaning</code> 并且没有参数。</li><li>选择器：表示消息或方法名称的一种特殊方式，表示为类型 SEL。选择器本质上就是不透明的字符串，它们被管理，因此可以使用简单的指针相等来比较它们，从而提高速度。（实现可能会有所不同，但这基本上是他们在外部看起来的样子。）例如：<code>@selector(meaning)</code>。</li><li>消息发送：接收信息并查找和执行适当方法的过程。</li></ul></article></html>