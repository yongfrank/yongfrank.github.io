<!doctype html><html lang=en-us><title>Comparison of Swift and Objc | Blog by Frank</title><meta charset=utf-8><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZQ6YTCMN7"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XZQ6YTCMN7",{anonymize_ip:!1})}</script><meta name=twitter:card content="summary_large_image"><meta property="og:type" content="article"><meta property="og:title" content="Comparison of Swift and Objc | Blog by Frank"><meta name=twitter:title content="Comparison of Swift and Objc | Blog by Frank"><meta property="og:description" content="block and closure
Objective-C中的Block和Swift中的闭包（Closure）都是一种匿名函数，可以作为参数传递给其他函数或者在函数内部定义。但它们在语法和使用上存在一些区别。"><meta property="og:url" content="https://yongfrank.github.io/posts/comparison-of-swift-and-objc/"><meta property="og:site_name" content="Blog by Frank"><meta name=generator content="Hugo 0.113.0"><meta name=description content="Explorations, Reflections, and More on My Blog"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://yongfrank.github.io/css/index.css><link rel=canonical href=https://yongfrank.github.io/posts/comparison-of-swift-and-objc/><link rel=alternate type=application/rss+xml href title="Blog by Frank"><link rel=stylesheet href=https://yongfrank.github.io/katex/katex.min.css><link rel="shortcut icon" href=favicon.ico><script defer src=https://yongfrank.github.io/katex/katex.min.js></script>
<script defer src=https://yongfrank.github.io/katex/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#578490><meta name=msapplication-TileColor content="#da532c"><head><script src=/js/MathJax/es5/tex-chtml.js></script></head><header><a href=https://yongfrank.github.io/ class=title>Blog by Frank</a><nav><a href=/about/>About</a></nav></header><article><header><h1>Comparison of Swift and Objc</h1><time datetime=2023-04-17T15:47:55+08:00>April 17, 2023</time></header><h2 id=block-and-closure>block and closure</h2><p>Objective-C中的Block和Swift中的闭包（Closure）都是一种匿名函数，可以作为参数传递给其他函数或者在函数内部定义。但它们在语法和使用上存在一些区别。</p><h3 id=语法>语法</h3><p>Objective-C的Block使用^运算符来定义，后面跟着参数列表和函数体，例如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objectivec data-lang=objectivec><span style=display:flex><span><span style=color:#66d9ef>void</span> (<span style=color:#f92672>^</span>myBlock)(<span style=color:#66d9ef>void</span>) <span style=color:#f92672>=</span> <span style=color:#f92672>^</span>{
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;Hello, world!&#34;</span>);
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>Swift的闭包使用{}来定义，参数列表和函数体在{}中定义，例如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> myClosure: () -&gt; Void = {
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Hello, world!&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=捕获变量>捕获变量</h3><p>Objective-C的Block可以捕获外部变量并在函数内部使用，例如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span>NSString <span style=color:#f92672>*</span>message <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;Hello, world!&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> (<span style=color:#f92672>^</span>myBlock)(<span style=color:#66d9ef>void</span>) <span style=color:#f92672>=</span> <span style=color:#f92672>^</span>{
</span></span><span style=display:flex><span>    NSLog(<span style=color:#e6db74>@&#34;%@&#34;</span>, message);
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>Swift的闭包也可以捕获外部变量，但是需要显式地声明捕获变量，并且可以指定捕获方式，例如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> message = <span style=color:#e6db74>&#34;Hello, world!&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> myClosure: () -&gt; Void = { [message] <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>    print(message)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=内存管理>内存管理</h3><p>Objective-C的Block需要手动管理内存，因为Block在创建时会捕获外部变量并将其包含在Block中。如果Block被复制到堆上，则需要使用__block修饰符来解决循环引用的问题。</p><p>Swift 的闭包使用<strong>捕获列表</strong>来捕获外部变量，并且自动管理内存。如果闭包被捕获并持有了一个对象，只要闭包存在，这个对象就会被保持在内存中。</p><p>总之，Objective-C的Block和Swift的闭包都是一种函数式编程的重要工具，可以用于编写更加简洁、灵活的代码。但是它们在语法和使用上存在一些区别，需要开发者根据实际情况进行选择和使用。</p><h2 id=ns-and-non-ns>NS and Non-NS</h2><h3 id=timeinterval--nstimeinterval>TimeInterval & NSTimeInterval</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>typealias</span> TimeInterval = Double
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objc data-lang=objc><span style=display:flex><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>double</span> NSTimeInterval;
</span></span></code></pre></div><h2 id=property>Property</h2><p>在 Swift 中，@property 被替换为普通的属性定义。nonatomic 属性特性在 Swift 中默认为使用。assign 属性特性用于简单类型的属性，表示直接赋值。NSTimeInterval 被替换为 TimeInterval，BOOL 被替换为 Bool，double 保持不变。</p><h3 id=nonatomic>nonatomic</h3><ul><li>非默认属性。</li><li>两个线程同时访问同一个属性将会导致无法预计的结果。</li><li>优点是程序运行速度快。</li></ul><h3 id=assign>assign</h3><ul><li>与copy相反，只是reference，不是owner。只返回指针。</li><li>用于float、int、BOOL等类型。</li><li>释放后再发送消息会导致程序崩溃。</li></ul><h2 id=class-init>Class Init</h2><p>在 Objective-C 中，我们使用 alloc 和 init 方法来创建对象实例。alloc 方法分配内存空间，init 方法对对象进行初始化，并返回初始化后的对象实例。</p><p>而在 Swift 中，我们可以使用简化的语法来创建对象实例。通过使用类名后跟一对空括号 ()，可以直接创建一个类的实例。</p><p>在给定的代码示例中，ViewController() 使用的是 Swift 中的对象创建语法，它等同于 Objective-C 中的 alloc init。因此，它们的作用是相同的，都是用来创建 ViewController 类的实例。</p><p>如果你的项目是使用 Objective-C 编写的，你应该使用 alloc init 的方式来创建对象实例。而如果你的项目是使用 Swift 编写的，你可以使用简化的语法 ViewController() 来创建对象实例。</p><h2 id=class-init-1>Class Init</h2><p>在 Objective-C 中，我们使用 alloc 和 init 方法来创建对象实例。alloc 方法分配内存空间，init 方法对对象进行初始化，并返回初始化后的对象实例。</p><p>而在 Swift 中，我们可以使用简化的语法来创建对象实例。通过使用类名后跟一对空括号 ()，可以直接创建一个类的实例。</p><p>在给定的代码示例中，ViewController() 使用的是 Swift 中的对象创建语法，它等同于 Objective-C 中的 alloc init。因此，它们的作用是相同的，都是用来创建 ViewController 类的实例。</p><p>如果你的项目是使用 Objective-C 编写的，你应该使用 alloc init 的方式来创建对象实例。而如果你的项目是使用 Swift 编写的，你可以使用简化的语法 ViewController() 来创建对象实例。</p></article></html>